angular.module("multi-select",["ng"]).directive("multiSelect",["$sce","$timeout","$filter","$rootScope",function($sce,$timeout,$filter,$rootScope){var templates={default:'<span class="multiSelect inlineBlock">'+'<button type="button" class="button multiSelectButton" ng-click="toggleCheckboxes( $event ); refreshSelectedItems(); refreshButton();" ng-bind-html="varButtonLabel">'+"</button>"+'<div class="checkboxLayer">'+"<form>"+"<div class=\"helperContainer\" ng-if=\"displayHelper( 'filter' ) || displayHelper( 'all' ) || displayHelper( 'none' ) || displayHelper( 'reset' )\">"+"<div class=\"line\" ng-if=\"displayHelper( 'all' ) || displayHelper( 'none' ) || displayHelper( 'reset' )\">"+'<button type="button" ng-click="select( \'all\',   $event );"    class="helperButton" ng-if="!isDisabled && displayHelper( \'all\' )">   &#10003;&nbsp; Select All</button> '+'<button type="button" ng-click="select( \'none\',  $event );"   class="helperButton" ng-if="!isDisabled && displayHelper( \'none\' )">  &times;&nbsp; Select None</button>'+'<button type="button" ng-click="select( \'reset\', $event );"  class="helperButton" ng-if="!isDisabled && displayHelper( \'reset\' )" style="float:right">&#8630;&nbsp; Reset</button>'+"</div>"+'<div class="line" style="position:relative" ng-if="displayHelper( \'filter\' )">'+'<input placeholder="Search..." type="text" ng-click="select( \'filter\', $event )" ng-model="inputLabel.labelFilter" ng-change="updateFilter();$scope.getFormElements();" class="inputFilter" />'+'<button type="button" class="clearButton" ng-click="inputLabel.labelFilter=\'\';updateFilter();prepareGrouping();prepareIndex();select( \'clear\', $event )">&times;</button> '+"</div>"+"</div>"+'<div class="checkBoxContainer" style="{{setHeight();}}">'+'<div ng-repeat="item in filteredModel | filter:removeGroupEndMarker" class="multiSelectItem"'+'ng-class="{selected: item[ tickProperty ], horizontal: orientationH, vertical: orientationV, multiSelectGroup:item[ groupProperty ], disabled:itemIsDisabled( item )}"'+'ng-click="syncItems( item, $event, $index );"'+'ng-mouseleave="removeFocusStyle( tabIndex );">'+'<div class="acol" ng-if="item[ spacingProperty ] > 0" ng-repeat="i in numberToArray( item[ spacingProperty ] ) track by $index">&nbsp;</div>'+'<div class="acol">'+"<label>"+'<input class="checkbox focusable" type="checkbox" ng-disabled="itemIsDisabled( item )" ng-checked="item[ tickProperty ]" ng-click="syncItems( item, $event, $index )" />'+'<span ng-class="{disabled:itemIsDisabled( item )}" ng-bind-html="writeLabel( item, \'itemLabel\' )"></span>'+"</label>"+"</div>"+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+'<span class="tickMark" ng-if="item[ groupProperty ] !== true && item[ tickProperty ] === true">&#10004;</span>'+"</div>"+"</div>"+"</form>"+"</div>"+"</span>",workmanagement:'<div class="select">'+'<div class="multi-select" ng-click="showOptions=true;toggleCheckboxes( $event ); refreshSelectedItems(); refreshButton();" ng-bind-html="varButtonLabel"></div>'+"</button>"+' <div class="multi-select-options" ng-class="{\'hidden\': !showOptions }">'+"<form>"+"<div class=\"helperContainer\" ng-if=\"displayHelper( 'filter' ) || displayHelper( 'all' ) || displayHelper( 'none' ) || displayHelper( 'reset' )\">"+"<div ng-hide=\"true\" class=\"line\" ng-if=\"displayHelper( 'all' ) || displayHelper( 'none' ) || displayHelper( 'reset' )\">"+'<button type="button" ng-click="select( \'all\',   $event );"    class="helperButton" ng-if="!isDisabled && displayHelper( \'all\' )">   &#10003;&nbsp; Select All</button> '+'<button type="button" ng-click="select( \'none\',  $event );"   class="helperButton" ng-if="!isDisabled && displayHelper( \'none\' )">  &times;&nbsp; Select None</button>'+'<button type="button" ng-click="select( \'reset\', $event );"  class="helperButton" ng-if="!isDisabled && displayHelper( \'reset\' )" style="float:right">&#8630;&nbsp; Reset</button>'+"</div>"+'<div ng-hide="true"class="line" style="position:relative" ng-if="displayHelper( \'filter\' )">'+'<input placeholder="Search..." type="text" ng-click="select( \'filter\', $event )" ng-model="inputLabel.labelFilter" ng-change="updateFilter();$scope.getFormElements();" class="inputFilter" />'+'<button type="button" class="clearButton" ng-click="inputLabel.labelFilter=\'\';updateFilter();prepareGrouping();prepareIndex();select( \'clear\', $event )">&times;</button> '+"</div>"+"</div>"+"<div class=\"entry search\" ng-class=\"{'visible': inputLabel.labelFilter.length }\" ng-if=\"displayHelper( 'filter' ) || displayHelper( 'all' ) || displayHelper( 'none' ) || displayHelper( 'reset' )\">"+'<button type="submit" name="submit" class="icons icon-search" ng-click="inputLabel.labelFilter=\'\';updateFilter();prepareGrouping();prepareIndex();select( \'clear\', $event )">&times;</button> '+'<input id="multi-select-query" class="query" placeholder="{{empPlaceholder}}" type="search" autocomplete="off" ng-click="select( \'filter\', $event )" ng-model="inputLabel.labelFilter" ng-change="updateFilter();$scope.getFormElements();" class="query" />'+"</div>"+'<div  id="multi-select-options" class="entry scrollable" ng-iscroll-delay=3000 ng-iscroll="{{scroller}}">'+'<div class="wrapper">'+'<label ng-if="filteredModel.length != 0" class="checkbox" ng-class="{\'checked\': isEmployeesSelected(), \'semi-checked\': isEmployeesPartiallySelected()}"> <span class="icon-form icon-checkbox" ng-class="{\'checked\': isEmployeesSelected(), \'semi-checked\': isEmployeesPartiallySelected()}"></span> <input name="multi-select-employees" value="all" type="checkbox" ng-click="toggleSelectOrDeselectAll()"> <em>Select all/none</em> </label>'+'<label ng-repeat="item in inputModel" class="inline"ng-class="{checkbox: item.show, checked: item[ tickProperty ], disabled:itemIsDisabled( item )}">'+'<div ng-if="item.show">'+'<span class="icon-form icon-checkbox" ng-class="{checked: item[ tickProperty ]}"></span>'+'<input type="checkbox" ng-class="{checked: item[ tickProperty ]}" ng-disabled="itemIsDisabled( item )" ng-checked="item[ tickProperty ]" ng-click="syncItems( item, $event, $index )" />'+'<span ng-class="{disabled:itemIsDisabled( item )}" ng-bind-html="writeLabel( item, \'itemLabel\' )"></span>'+"</div>"+"</label>"+"</div>"+"</div>"+"</form>"+"</div>"+"</div>"};return{restrict:"AE",replace:true,scope:{inputModel:"=",outputModel:"=",buttonLabel:"@",defaultLabel:"@",directiveId:"@",helperElements:"@",isDisabled:"=",itemLabel:"@",maxLabels:"@",orientation:"@",scroller:"@",selectionMode:"@",customTemplate:"@",tickProperty:"@",disableProperty:"@",groupProperty:"@",maxHeight:"@",onClose:"&",onItemClick:"&",onOpen:"&"},template:function($scope,attrs){return templates[attrs.customTemplate]||templates.default},link:function($scope,element,attrs){$scope.backUp=[];$scope.varButtonLabel="";$scope.scrolled=false;$scope.spacingProperty="";$scope.indexProperty="";$scope.checkBoxLayer="";$scope.orientationH=false;$scope.orientationV=true;$scope.filteredModel=[];$scope.inputLabel={labelFilter:""};$scope.selectedItems=[];$scope.formElements=[];$scope.tabIndex=0;$scope.clickedItem=null;var prevTabIndex=0;var helperItems=[];var helperItemsLength=0;$scope.showOptions=false;var prevTabIndex=0;var helperItems=[];var helperItemsLength=0;var ctr=0;var refreshScroller=$scope.$parent.refreshScroller;$scope.isEmployeesSelected=function(){var isChecked,selectedEmployees=_.filter($scope.filteredModel,function(obj){return typeof obj[$scope.tickProperty]!=="undefined"&&obj[$scope.tickProperty]===true});if(selectedEmployees.length===$scope.filteredModel.length){isChecked=true}else{isChecked=false}return isChecked};$scope.isEmployeesPartiallySelected=function(){var isPartiallySelected,selectedEmployees=_.filter($scope.filteredModel,function(obj){return typeof obj[$scope.tickProperty]!=="undefined"&&obj[$scope.tickProperty]===true});if(selectedEmployees.length!==0&&selectedEmployees.length!==$scope.filteredModel.length){isPartiallySelected=true}else{isPartiallySelected=false}return isPartiallySelected};$scope.setHeight=function(){if(typeof $scope.maxHeight!=="undefined"){return"max-height: "+$scope.maxHeight+"; overflow-y:scroll"}};$scope.numberToArray=function(num){return new Array(num)};_.each($scope.inputModel,function(each){each.show=true});$scope.updateFilter=function(){$scope.filteredModel=[];var i=0;if(typeof $scope.inputModel==="undefined"){return[]}for(i=$scope.inputModel.length-1;i>=0;i--){if(typeof $scope.inputModel[i][$scope.groupProperty]!=="undefined"&&$scope.inputModel[i][$scope.groupProperty]===false){$scope.filteredModel.push($scope.inputModel[i])}var gotData=false;if(typeof $scope.inputModel[i][$scope.groupProperty]==="undefined"){for(var key in $scope.inputModel[i]){if(typeof $scope.inputModel[i][key]!=="boolean"&&String($scope.inputModel[i][key]).toUpperCase().indexOf($scope.inputLabel.labelFilter.toUpperCase())>=0){gotData=true;break}}if(gotData===true){$scope.inputModel[i].show=true;$scope.filteredModel.push($scope.inputModel[i])}else{$scope.inputModel[i].show=false}}if(typeof $scope.inputModel[i][$scope.groupProperty]!=="undefined"&&$scope.inputModel[i][$scope.groupProperty]===true){if(typeof $scope.filteredModel[$scope.filteredModel.length-1][$scope.groupProperty]!=="undefined"&&$scope.filteredModel[$scope.filteredModel.length-1][$scope.groupProperty]===false){$scope.filteredModel.pop()}else{$scope.filteredModel.push($scope.inputModel[i])}}}$scope.filteredModel.reverse();$timeout(function(){$scope.getFormElements()},0);refreshScroller($scope.scroller)};$scope.getFormElements=function(){$scope.formElements=[];for(var i=0;i<element[0].getElementsByTagName("FORM")[0].elements.length;i++){$scope.formElements.push(element[0].getElementsByTagName("FORM")[0].elements[i])}};$scope.isGroupMarker=function(item,type){if(typeof item[$scope.groupProperty]!=="undefined"&&item[$scope.groupProperty]===type)return true;return false};$scope.removeGroupEndMarker=function(item){if(typeof item[$scope.groupProperty]!=="undefined"&&item[$scope.groupProperty]===false)return false;return true};$scope.displayHelper=function(elementString){if(attrs.selectionMode&&$scope.selectionMode.toUpperCase()==="SINGLE"){switch(elementString.toUpperCase()){case"ALL":return false;break;case"NONE":return false;break;case"RESET":if(typeof attrs.helperElements==="undefined"){return true}else if(attrs.helperElements&&$scope.helperElements.toUpperCase().indexOf("RESET")>=0){return true}break;case"FILTER":if(typeof attrs.helperElements==="undefined"){return true}if(attrs.helperElements&&$scope.helperElements.toUpperCase().indexOf("FILTER")>=0){return true}break;default:break}return false}else{if(typeof attrs.helperElements==="undefined"){return true}if(attrs.helperElements&&$scope.helperElements.toUpperCase().indexOf(elementString.toUpperCase())>=0){return true}return false}};$scope.syncItems=function(item,e,ng_repeat_index){e.preventDefault();e.stopPropagation();$scope.isEmployeesSelected();if(typeof attrs.disableProperty!=="undefined"&&item[$scope.disableProperty]===true){return false}if(typeof attrs.isDisabled!=="undefined"&&$scope.isDisabled===true){return false}if(typeof item[$scope.groupProperty]!=="undefined"&&item[$scope.groupProperty]===false){return false}var index=$scope.filteredModel.indexOf(item);if(typeof item[$scope.groupProperty]!=="undefined"&&item[$scope.groupProperty]===true){if(attrs.selectionMode&&$scope.selectionMode.toUpperCase()==="SINGLE"){return false}var i,j,k;var startIndex=0;var endIndex=$scope.filteredModel.length-1;var tempArr=[];var nestLevel=0;for(i=index;i<$scope.filteredModel.length;i++){if(nestLevel===0&&i>index){break}if(typeof $scope.filteredModel[i][$scope.groupProperty]!=="undefined"&&$scope.filteredModel[i][$scope.groupProperty]===true){if(tempArr.length===0){startIndex=i+1}nestLevel=nestLevel+1}else if(typeof $scope.filteredModel[i][$scope.groupProperty]!=="undefined"&&$scope.filteredModel[i][$scope.groupProperty]===false){nestLevel=nestLevel-1;if(tempArr.length>0&&nestLevel===0){var allTicked=true;endIndex=i;for(j=0;j<tempArr.length;j++){if(typeof tempArr[j][$scope.tickProperty]!=="undefined"&&tempArr[j][$scope.tickProperty]===false){allTicked=false;break}}if(allTicked===true){for(j=startIndex;j<=endIndex;j++){if(typeof $scope.filteredModel[j][$scope.groupProperty]==="undefined"){if(typeof attrs.disableProperty==="undefined"){$scope.filteredModel[j][$scope.tickProperty]=false;inputModelIndex=$scope.filteredModel[j][$scope.indexProperty];$scope.inputModel[inputModelIndex][$scope.tickProperty]=false}else if($scope.filteredModel[j][$scope.disableProperty]!==true){$scope.filteredModel[j][$scope.tickProperty]=false;inputModelIndex=$scope.filteredModel[j][$scope.indexProperty];$scope.inputModel[inputModelIndex][$scope.tickProperty]=false}}}}else{for(j=startIndex;j<=endIndex;j++){if(typeof $scope.filteredModel[j][$scope.groupProperty]==="undefined"){if(typeof attrs.disableProperty==="undefined"){$scope.filteredModel[j][$scope.tickProperty]=true;inputModelIndex=$scope.filteredModel[j][$scope.indexProperty];$scope.inputModel[inputModelIndex][$scope.tickProperty]=true}else if($scope.filteredModel[j][$scope.disableProperty]!==true){$scope.filteredModel[j][$scope.tickProperty]=true;inputModelIndex=$scope.filteredModel[j][$scope.indexProperty];$scope.inputModel[inputModelIndex][$scope.tickProperty]=true}}}}}}else{tempArr.push($scope.filteredModel[i])}}}else{if(attrs.selectionMode&&$scope.selectionMode.toUpperCase()==="SINGLE"){for(i=0;i<$scope.filteredModel.length;i++){$scope.filteredModel[i][$scope.tickProperty]=false}for(i=0;i<$scope.inputModel.length;i++){$scope.inputModel[i][$scope.tickProperty]=false}$scope.filteredModel[index][$scope.tickProperty]=true;$scope.toggleCheckboxes(e)}else{$scope.filteredModel[index][$scope.tickProperty]=!$scope.filteredModel[index][$scope.tickProperty]}inputModelIndex=$scope.filteredModel[index][$scope.indexProperty];$scope.inputModel[inputModelIndex][$scope.tickProperty]=$scope.filteredModel[index][$scope.tickProperty]}$scope.clickedItem=angular.copy(item);prevTabIndex=$scope.tabIndex;$scope.tabIndex=ng_repeat_index+helperItemsLength;e.target.focus();$scope.removeFocusStyle(prevTabIndex);$scope.setFocusStyle($scope.tabIndex)};$scope.toggleSelectOrDeselectAll=function(){var isAllSelected=$scope.isEmployeesSelected();if(!isAllSelected){for(var i=0;i<$scope.filteredModel.length;i++){$scope.filteredModel[i][$scope.tickProperty]=true}}else{for(var i=0;i<$scope.filteredModel.length;i++){$scope.filteredModel[i][$scope.tickProperty]=false}}};$scope.refreshSelectedItems=function(){$scope.selectedItems=[];angular.forEach($scope.inputModel,function(value,key){if(typeof value!=="undefined"){if(typeof value[$scope.groupProperty]==="undefined"){if(value[$scope.tickProperty]===true){$scope.selectedItems.push(value)}}}})};$scope.refreshOutputModel=function(){if(typeof attrs.outputModel!=="undefined"){$scope.outputModel=angular.copy($scope.selectedItems);angular.forEach($scope.outputModel,function(value,key){delete value[$scope.indexProperty];delete value[$scope.spacingProperty]})}};$scope.refreshButton=function(){$scope.varButtonLabel="";$scope.empPlaceholder=$filter("translate")("SEARCH_BY_EMP_NAME");var ctr=0;if($scope.selectedItems.length===0){$scope.varButtonLabel=typeof $scope.defaultLabel!=="undefined"?$scope.defaultLabel:$filter("translate")("NONE_SELECTED")}else{var tempMaxLabels=$scope.selectedItems.length;if(typeof $scope.maxLabels!=="undefined"&&$scope.maxLabels!==""){tempMaxLabels=$scope.maxLabels}if($scope.selectedItems.length>tempMaxLabels){$scope.more=true}else{$scope.more=false}angular.forEach($scope.selectedItems,function(value,key){if(typeof value!=="undefined"){if(ctr<tempMaxLabels){$scope.varButtonLabel+=($scope.varButtonLabel.length>0?'</div>, <div class="buttonLabel">':'<div class="buttonLabel">')+$scope.writeLabel(value,"buttonLabel")}ctr++}});if($scope.more===true){if(tempMaxLabels>0){$scope.varButtonLabel+=", ... "}$scope.varButtonLabel+=" "+$scope.selectedItems.length+" "+$filter("translate")("SELECTED_EMP")+" ..."}}$scope.varButtonLabel=$sce.trustAsHtml($scope.varButtonLabel+'<span class="caret"></span>')};$scope.itemIsDisabled=function(item){if(typeof attrs.disableProperty!=="undefined"&&item[$scope.disableProperty]===true){return true}else{if($scope.isDisabled===true){return true}else{return false}}};$scope.writeLabel=function(item,type){var label="";var temp=$scope[type].split(" ");angular.forEach(temp,function(value2,key2){if(typeof value2!=="undefined"){angular.forEach(item,function(value1,key1){if(key1==value2){label+="&nbsp;"+value1}})}});if(type.toUpperCase()==="BUTTONLABEL"){return label}return $sce.trustAsHtml(label)};$scope.toggleCheckboxes=function(e){$scope.checkBoxLayer=element.children()[1];var clickedEl=element.children()[0];angular.element(document).unbind("click",$scope.externalClickListener);angular.element(document).unbind("keydown",$scope.keyboardListener);$scope.inputLabel.labelFilter="";$scope.updateFilter();if(e.keyCode===27){angular.element($scope.checkBoxLayer).removeClass("show");angular.element(clickedEl).removeClass("buttonClicked");angular.element(document).unbind("click",$scope.externalClickListener);angular.element(document).unbind("keydown",$scope.keyboardListener);$scope.removeFocusStyle($scope.tabIndex);$scope.showOptions=false;$scope.onClose({data:element});return true}if(angular.element($scope.checkBoxLayer).hasClass("show")){angular.element($scope.checkBoxLayer).removeClass("show");angular.element(clickedEl).removeClass("buttonClicked");angular.element(document).unbind("click",$scope.externalClickListener);angular.element(document).unbind("keydown",$scope.keyboardListener);$scope.removeFocusStyle($scope.tabIndex);$scope.showOptions=false;$scope.onClose({data:element})}else{helperItems=[];helperItemsLength=0;angular.element($scope.checkBoxLayer).addClass("show");angular.element(clickedEl).addClass("buttonClicked");angular.element(document).bind("click",$scope.externalClickListener);angular.element(document).bind("keydown",$scope.keyboardListener);$scope.getFormElements();$scope.tabIndex=0;var helperContainer=angular.element(element[0].querySelector(".helperContainer"))[0];if(typeof helperContainer!=="undefined"){for(var i=0;i<helperContainer.getElementsByTagName("BUTTON").length;i++){helperItems[i]=helperContainer.getElementsByTagName("BUTTON")[i]}helperItemsLength=helperItems.length+helperContainer.getElementsByTagName("INPUT").length}if(element[0].querySelector(".inputFilter")){element[0].querySelector(".inputFilter").focus();$scope.tabIndex=$scope.tabIndex+helperItemsLength-2}else{$scope.formElements[$scope.tabIndex].focus()}$scope.onOpen({data:element});$timeout(refreshScroller.bind(null,$scope.scroller),200)}};$scope.externalClickListener=function(e){var targetsArr=element.find(e.target.tagName);for(var i=0;i<targetsArr.length;i++){if(e.target==targetsArr[i]){return}}angular.element($scope.checkBoxLayer.previousSibling).removeClass("buttonClicked");angular.element($scope.checkBoxLayer).removeClass("show");angular.element(document).unbind("click",$scope.externalClickListener);angular.element(document).unbind("keydown",$scope.keyboardListener);$scope.showOptions=false;$timeout(function(){$scope.onClose({data:element})},0)};$scope.findUpTag=function(el,tag,className){while(el.parentNode){el=el.parentNode;if(typeof el.tagName!=="undefined"){if(el.tagName.toUpperCase()===tag.toUpperCase()&&el.className.indexOf(className)>-1){return el}}}return null};$scope.select=function(type,e){var helperIndex=helperItems.indexOf(e.target);$scope.tabIndex=helperIndex;switch(type.toUpperCase()){case"ALL":angular.forEach($scope.filteredModel,function(value,key){if(typeof value!=="undefined"&&value[$scope.disableProperty]!==true){if(typeof value[$scope.groupProperty]==="undefined"){value[$scope.tickProperty]=true}}});break;case"NONE":angular.forEach($scope.filteredModel,function(value,key){if(typeof value!=="undefined"&&value[$scope.disableProperty]!==true){if(typeof value[$scope.groupProperty]==="undefined"){value[$scope.tickProperty]=false}}});break;case"RESET":angular.forEach($scope.filteredModel,function(value,key){if(typeof value[$scope.groupProperty]==="undefined"&&typeof value!=="undefined"&&value[$scope.disableProperty]!==true){temp=value[$scope.indexProperty];value[$scope.tickProperty]=$scope.backUp[temp][$scope.tickProperty]}});break;case"CLEAR":$scope.tabIndex=$scope.tabIndex+1;break;case"FILTER":$scope.tabIndex=helperItems.length-1;break;default:}};var genRandomString=function(length){var possible="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";var temp="";for(var i=0;i<length;i++){temp+=possible.charAt(Math.floor(Math.random()*possible.length))}return temp};$scope.prepareGrouping=function(){var spacing=0;angular.forEach($scope.filteredModel,function(value,key){value[$scope.spacingProperty]=spacing;if(value[$scope.groupProperty]===true){spacing+=2}else if(value[$scope.groupProperty]===false){spacing-=2}})};$scope.prepareIndex=function(){var ctr=0;angular.forEach($scope.filteredModel,function(value,key){value[$scope.indexProperty]=ctr;ctr++})};$scope.keyboardListener=function(e){var key=e.keyCode?e.keyCode:e.which;var isNavigationKey=false;if(key===27){$scope.toggleCheckboxes(e)}else if(key===40||key===39||!e.shiftKey&&key==9){isNavigationKey=true;prevTabIndex=$scope.tabIndex;$scope.tabIndex++;if($scope.tabIndex>$scope.formElements.length-1){$scope.tabIndex=0;prevTabIndex=$scope.formElements.length-1}while($scope.formElements[$scope.tabIndex].disabled===true){$scope.tabIndex++;if($scope.tabIndex>$scope.formElements.length-1){$scope.tabIndex=0}}}else if(key===38||key===37||e.shiftKey&&key==9){isNavigationKey=true;prevTabIndex=$scope.tabIndex;$scope.tabIndex--;if($scope.tabIndex<0){$scope.tabIndex=$scope.formElements.length-1;prevTabIndex=0}while($scope.formElements[$scope.tabIndex].disabled===true){$scope.tabIndex--;if($scope.tabIndex<0){$scope.tabIndex=$scope.formElements.length-1}}}if(isNavigationKey===true){e.preventDefault();e.stopPropagation();$scope.formElements[$scope.tabIndex].focus();var actEl=document.activeElement;if(actEl.type.toUpperCase()==="CHECKBOX"){$scope.setFocusStyle($scope.tabIndex);$scope.removeFocusStyle(prevTabIndex)}else{$scope.removeFocusStyle(prevTabIndex);$scope.removeFocusStyle(helperItemsLength);$scope.removeFocusStyle($scope.formElements.length-1)}}isNavigationKey=false};$scope.setFocusStyle=function(tabIndex){angular.element($scope.formElements[tabIndex]).parent().parent().parent().addClass("multiSelectFocus")};$scope.removeFocusStyle=function(tabIndex){angular.element($scope.formElements[tabIndex]).parent().parent().parent().removeClass("multiSelectFocus")};var tempStr=genRandomString(5);$scope.indexProperty="idx_"+tempStr;$scope.spacingProperty="spc_"+tempStr;if(typeof attrs.orientation!=="undefined"){if(attrs.orientation.toUpperCase()==="HORIZONTAL"){$scope.orientationH=true;$scope.orientationV=false}else{$scope.orientationH=false;$scope.orientationV=true}}$scope.$watch("inputModel",function(newVal){if(newVal){$scope.refreshSelectedItems();$scope.refreshOutputModel();$scope.refreshButton();if($scope.clickedItem!==null){$timeout(function(){$scope.onItemClick({data:$scope.clickedItem});$scope.clickedItem=null},0)}}},true);$scope.$watch("inputModel",function(newVal){if(newVal){$scope.backUp=angular.copy($scope.inputModel);$scope.updateFilter();$scope.prepareGrouping();$scope.prepareIndex();$scope.refreshSelectedItems();$scope.refreshOutputModel();$scope.refreshButton()}});$scope.$watch("isDisabled",function(newVal){$scope.isDisabled=newVal});angular.element(document).bind("touchstart",function(e){$scope.$apply(function(){$scope.scrolled=false})});angular.element(document).bind("touchmove",function(e){$scope.$apply(function(){$scope.scrolled=true})});var languageChangeListner=$rootScope.$on("LANGUAGE_CHANGED",function(){$timeout(function(){$scope.refreshButton()},100)});$scope.$on("$destroy",languageChangeListner);if(!Array.prototype.indexOf){Array.prototype.indexOf=function(what,i){i=i||0;var L=this.length;while(i<L){if(this[i]===what)return i;++i}return-1}}}}}]);
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("angular")):"function"==typeof define&&define.amd?define(["angular"],t):"object"==typeof exports?exports["ng-augment-native-scroll"]=t(require("angular")):e["ng-augment-native-scroll"]=t(e.angular)}(window,function(e){return function(e){function __webpack_require__(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}var t={};return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.i=function(e){return e},__webpack_require__.d=function(e,t,o){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=7)}([function(e,t,o){"use strict";var r={enableKinetics:!0,movingAverage:.1,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/}};e.exports=r},function(e,t){function augNsUtils(){return function(){for(var e=0,t=["ms","moz","webkit","o"],o=0;o<t.length&&!window.requestAnimationFrame;++o)window.requestAnimationFrame=window[t[o]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[o]+"CancelAnimationFrame"]||window[t[o]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var o=(new Date).getTime(),r=Math.max(0,16-(o-e)),n=window.setTimeout(function(){t(o+r)},r);return e=o+r,n}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),{findMatchingTarget:function(e,t){var o;return t.length&&"BODY"!==e.tagName?(o=t.find(function(t){return t.id===e.id}),o?e.id:this.findMatchingTarget(e.parentElement,t)):"BODY"},getPoint:function(e,t){var o;return o=t&&event.touches.length?{x:event.touches[0].clientX,y:event.touches[0].clientY}:{x:event.clientX,y:event.clientY}},getTime:Date.now||function(){return(new Date).utils.getTime()},preventDefaultException:function(e,t){for(var o in t)if(t[o].test(e[o]))return!0;return!1},getMaxScroll:function(e){var t=0,o=0;return e.forEach(function(e){var r=e.children[0],n=r.scrollWidth-r.clientWidth,l=r.scrollHeight-r.clientHeight;n>t&&(t=n),l>o&&(o=l)}),{left:t,top:o}}}}e.exports=augNsUtils},function(e,t,o){"use strict";function ConnectScrolls(e,t,o){return{restrict:"E",scope:{options:"="},transclude:!0,replace:!0,template:'<span data-name="conntect-scroll" ng-transclude></span>',link:function(r,n){r.hasTouch="ontouchstart"in window,r.DETECT_EVT=r.hasTouch?"touchstart":"mouseover",r.activeId=void 0,r.$listener=n[0],r.userOptions=angular.extend({},t,r.options),o.call(this,r,e),r.setActiveNode=function(t){r.activeId=e.findMatchingTarget(t.target,r.childNodes),r.hasTouch&&r.cancelAutoScroll()},r.onScroll=function(e){var t=e.target,o=void 0,n=void 0;return r.pressed||r.isAutoScrolling?(e.preventDefault(),void e.stopPropagation()):(t.clientWidth!==t.scrollWidth?(o=t.scrollLeft,r.lastScrollLeft=r.scrollLeft,r.scrollLeft=o):o=r.scrollLeft,t.clientHeight!==t.scrollHeight?(n=t.scrollTop,r.lastScrollTop=r.scrollTop,r.scrollTop=n):n=r.scrollTop,void r.childNodes.forEach(function(e){e.id!==r.activeId&&(e.children[0].scrollLeft=o,e.children[0].scrollTop=n)}))},r.$listener.addEventListener(r.DETECT_EVT,r.setActiveNode,!0),r.$listener.addEventListener("scroll",r.onScroll,!0),r.$on("$destroy",function(){r.$listener.removeEventListener(r.DETECT_EVT,r.setActiveNode),r.$listener.removeEventListener("scroll",r.onScroll)}),r.userOptions.hasOwnProperty("name")&&(r.$parent[r.userOptions.name]=r.exposedMethods)},controller:["$scope",function(e){var t=e.childNodes=[];this.addScrollArea=function(e){t.push(e)}}]}}ConnectScrolls.$inject=["augNsUtils","augNsOptions","kineticEngine"],e.exports=ConnectScrolls},function(e,t,o){"use strict";function KineticEngine(e,t){e.scrollLeft=0,e.scrollTop=0,e.lastScrollLeft=0,e.lastScrollTop=0,e.targetTop=0,e.targetLeft=0,e.velocityTop=0,e.velocityLeft=0,e.amplitudeTop=0,e.amplitudeLeft=0,e.timeStamp=0,e.referenceX=0,e.referenceY=0,e.pressed=!1,e.autoScrollTracker=null,e.isAutoScrolling=!1,e.leftTracker=function(){var o,r,n;o=t.getTime(),r=o-e.timeStamp,e.timeStamp=o,n=e.scrollLeft-e.lastScrollLeft,e.lastScrollLeft=e.scrollLeft,e.velocityLeft=e.userOptions.movingAverage*(1e3*n/(1+r))+.2*e.velocityLeft},e.topTracker=function(){var o,r,n;o=t.getTime(),r=o-e.timeStamp,e.timeStamp=o,n=e.scrollTop-e.lastScrollTop,e.lastScrollTop=e.scrollTop,e.velocityTop=e.userOptions.movingAverage*(1e3*n/(1+r))+.2*e.velocityTop},e.scroll=function(t,o){var r=Math.round(t),n=Math.round(o);e.childNodes.forEach(function(t){var o=t.children[0],l=o.scrollWidth-o.clientWidth,i=o.scrollHeight-o.clientHeight;l>0&&r>=0&&r<=l&&(o.scrollLeft=r,e.scrollLeft=r),i>0&&n>=0&&n<=i&&(o.scrollTop=n,e.scrollTop=n)})},e.autoScroll=function(){var o,r=0,n=0,l=0,i=0,c=325;o=t.getTime()-e.timeStamp,e.amplitudeTop&&(r=-e.amplitudeTop*Math.exp(-o/c)),e.amplitudeLeft&&(n=-e.amplitudeLeft*Math.exp(-o/c)),l=n>.5||n<-.5?n:0,i=r>.5||r<-.5?r:0,e.scroll(e.targetLeft+l,e.targetTop+i),0!==l||0!==i?e.autoScrollTracker=requestAnimationFrame(e.autoScroll):(e.isAutoScrolling=!1,e.autoScrollTracker=null)},e.triggerAutoScroll=function(o,r,n,l){0===n&&0===l||(e.cancelAutoScroll(),e.timeStamp=t.getTime(),e.targetLeft=o,e.targetTop=r,e.amplitudeLeft=n,e.amplitudeTop=l,e.isAutoScrolling=!0,e.autoScrollTracker=requestAnimationFrame(e.autoScroll))},e.cancelAutoScroll=function(){e.isAutoScrolling&&(cancelAnimationFrame(e.autoScrollTracker),e.isAutoScrolling=!1,e.autoScrollTracker=null)},e.tap=function(o){e.pressed=!0,e.referenceX=t.getPoint(o,e.hasTouch).x,e.referenceY=t.getPoint(o,e.hasTouch).y,e.velocityTop=e.amplitudeTop=0,e.velocityLeft=e.amplitudeLeft=0,e.lastScrollTop=e.scrollTop,e.lastScrollLeft=e.scrollLeft,e.timeStamp=t.getTime(),e.cancelAutoScroll(),e.$listener.addEventListener("mousemove",e.swipe,!0),e.$listener.addEventListener("mouseup",e.release,!0),t.preventDefaultException(o.target,e.userOptions.preventDefaultException)&&o.preventDefault()},e.swipe=function(o){var r,n,l,i;e.pressed&&(r=t.getPoint(o,e.hasTouch).x,n=t.getPoint(o,e.hasTouch).y,l=e.referenceX-r,i=e.referenceY-n,l>2||l<-2?e.referenceX=r:l=0,i>2||i<-2?e.referenceY=n:i=0,e.topTracker(),e.leftTracker(),e.scroll(e.scrollLeft+l,e.scrollTop+i))},e.release=function(){var t,o,r,n;e.pressed=!1,e.topTracker(),e.leftTracker(),e.velocityLeft>10||e.velocityLeft<-10?(r=.8*e.velocityLeft,t=Math.round(e.scrollLeft+r)):t=e.scrollLeft,e.velocityTop>10||e.velocityTop<-10?(n=.8*e.velocityTop,o=Math.round(e.scrollTop+n)):o=e.scrollTop,e.triggerAutoScroll(t,o,r,n),e.$listener.removeEventListener("mousemove",e.swipe),e.$listener.removeEventListener("mouseup",e.release)},!e.hasTouch&&e.userOptions.enableKinetics&&e.$listener.addEventListener("mousedown",e.tap,!0),e.$on("$destroy",function(){e.$listener.removeEventListener("mousedown",e.tap)});var o=function(o,r,n){return function(){var l=0,i=0,c=0,a=0,s={};o?(l=r?0:e.scrollLeft,i=n?0:e.scrollTop,c=r?-e.scrollLeft:0,a=n?-e.scrollTop:0):(s=t.getMaxScroll(e.childNodes),l=r?s.left:e.scrollLeft,i=n?s.top:e.scrollTop,c=r?s.left-e.scrollLeft:0,a=n?s.top-e.scrollTop:0),e.triggerAutoScroll(l,i,c,a)}},r=function(o){return function(r,n){var l,i,c,a,s,u,p,f,d,m,T;l=t.getMaxScroll(e.childNodes),i=parseInt(r),a=parseInt(n),c=isNaN(i)?e.scrollLeft:o?i+e.scrollLeft:i,s=isNaN(a)?e.scrollTop:o?a+e.scrollTop:a,u=c>l.left?l.left:c<0?0:c,p=s>l.top?l.top:s<0?0:s,f=e.scrollLeft-u!==0,d=e.scrollTop-p!==0,m=f?u-e.scrollLeft:0,T=d?p-e.scrollTop:0,e.triggerAutoScroll(u,p,m,T)}},n=!0,l=!1,i=!0,c=!1,a=!0,s=!1,u=!1,p=!0;e.exposedMethods={scrollToStart:o(n,i,a),scrollToStartLeft:o(n,i,s),scrollToStartTop:o(n,c,a),scrollToEnd:o(l,i,a),scrollToEndLeft:o(l,i,s),scrollToEndTop:o(l,c,a),scrollToPosition:r(u),scrollByValue:r(p)}}e.exports=KineticEngine},function(e,t,o){"use strict";function KineticScroll(e,t,o){return{restrict:"E",scope:{options:"="},transclude:!0,replace:!0,template:'<span data-name="kinetic-scroll" ng-transclude></span>',link:function(r,n){r.hasTouch="ontouchstart"in window,r.DETECT_EVT=r.hasTouch?"touchstart":"mouseover",r.$listener=n[0],r.childNodes=[r.$listener],r.userOptions=angular.extend({},t,r.options),o.call(this,r,e),r.userOptions.hasOwnProperty("name")&&(r.$parent[r.userOptions.name]=r.exposedMethods)}}}KineticScroll.$inject=["augNsUtils","augNsOptions","kineticEngine"],e.exports=KineticScroll},function(e,t,o){"use strict";function ScrollArea(){return{require:"^^connectScrolls",restrict:"E",transclude:!0,replace:!0,template:'<span  data-name="scroll-area" ng-transclude></span>',link:function(e,t,o,r){t.attr("id","PARTICIPATING_NODE_"+Math.random().toString().substring(2,15)),r.addScrollArea(t[0])}}}e.exports=ScrollArea},function(t,o){t.exports=e},function(e,t,o){"use strict";function main(){var e=o(6),t="ng-augment-native-scroll";return e.module(t,[]).factory("augNsUtils",o(1)).value("augNsOptions",o(0)).value("kineticEngine",o(3)).directive("connectScrolls",o(2)).directive("scrollArea",o(5)).directive("kineticScroll",o(4)),t}e.exports=main()}])});
"use strict";function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}sntRover.directive("rvDelayTextbox",["$timeout",function(e){return{restrict:"A",scope:{delay:"@delay",ngModel:"=ngModel",functionToFire:"=functionToFire",functionParam:"=functionParam"},link:function(e,t,n){"undefined"==typeof e.delay&&(e.delay=2e3),t.bind("keyup",function(t){e.currentTimeoutFn?(clearTimeout(e.currentTimeoutFn),e.currentTimeoutFn=setTimeout(function(){e.functionToFire(e.functionParam)},e.delay)):e.currentTimeoutFn=setTimeout(function(){e.functionToFire(e.functionParam)},e.delay)})}}}]),sntRover.directive("autoGrowField",["$window",function(e){return{require:"ngModel",scope:{value:"=ngModel"},link:function(t,n,r){var a=function(){var t=angular.element("<div>"),r=e.document.defaultView.getComputedStyle(n[0],"");t.css({"font-family":r.fontFamily,"line-height":r.lineHeight,"font-size":r.fontSize,"font-weight":r.fontWeight,width:"auto",position:"absolute",top:"-99999px",left:"-99999px"}),$("body").append(t),t.text(n.val()),!n.val()&&n.attr("placeholder")&&t.text(n.attr("placeholder"));var a=t[0].getBoundingClientRect(),o=a.width+40;n.css("width",o+"px"),t.remove()};a(),t.$watch("value",function(e,t){a()}),e.setTimeout(a,3e3),n.bind("keydown",function(){e.setTimeout(a,0)}),n.bind("focus",function(){n.addClass("active")}),n.bind("blur",function(){n.removeClass("active")})}}}]),sntRover.directive("rvCheckbox",["$timeout",function(e){return{restrict:"AE",replace:"true",scope:{label:"@label",required:"@required",isChecked:"=isChecked",parentLabelClass:"@parentLabelClass",divClass:"@divClass",change:"=change",datagroup:"@datagroup",isDisabled:"=isDisabled",index:"@index"},templateUrl:"/assets/directives/checkBox/rvCheckbox.html"}}]),sntRover.directive("rvCheckboxgrp",["$timeout",function(e){return{restrict:"AE",scope:{label:"@label",isChecked:"=isChecked",deleteAction:"&deleteAction",toggle:"&toggle",optionId:"=optionId"},templateUrl:"/assets/directives/checkBox/rvCheckboxGroup.html"}}]),sntRover.directive("rvCheckboxtextLeft",["$timeout",function(e){return{restrict:"AE",replace:"true",scope:{label:"@label",required:"@required",isChecked:"=isChecked",parentLabelClass:"@parentLabelClass",divClass:"@divClass",change:"=change",datagroup:"@datagroup",index:"@index",isDisabled:"@isDisabled",width:"@"},templateUrl:"/assets/directives/checkBox/rvCheckboxLeftText.html"}}]),sntRover.directive("rvClearTextBox",[function(){var e,t;return e={listenThis:"=listenThis"},t=function(e,t,n){var r=e.$watch("listenThis",function(n,r){"undefined"!=typeof e.listenThis&&null!==e.listenThis&&""!==e.listenThis.toString().trim()&&e.listenThis||t.val("")});e.$on("$destroy",r)},{restrict:"A",scope:e,link:t}}]),sntRover.directive("appFilereader",["$q",function(e){var t=Array.prototype.slice;return{restrict:"A",require:"?ngModel",link:function(n,r,a,o){o&&(o.$render=function(){},r.bind("change",function(r){function a(t){var r=e.defer(),a=new FileReader;return a.onload=function(e){t&&(t.base64=e.target.result,n.$emit("FILE_UPLOADED",t)),r.resolve(e.target.result)},a.onerror=function(e){r.reject(e)},a.readAsDataURL(t),n.fileName=t.name,r.promise}var i=r.target;e.all(t.call(i.files,0).map(a)).then(function(e){i.multiple?o.$setViewValue(e):o.$setViewValue(e.length?e[0]:null)})}))}}}]),sntRover.directive("rvIncludeTemplate",function(){return{restrict:"AE",replace:!0,templateUrl:function(e,t){return t.rvIncludeTemplate}}}),angular.module("sntRover").directive("autoCompleteGroups",["RVSearchSrv","highlightFilter","rvUtilSrv",function(e,t,n){return{restrict:"A",require:"ngModel",templateUrl:"/assets/directives/autocomplete/rvAutoCompleteGroups/rvAutoCompleteGroups.html",link:function(r,a,o,i){BaseCtrl.call(this,r);var l=null,s="",c=function(){r.$$phase||r.$digest()},u=function(t,n){if(0===t.term.length)i.$setViewValue(null),r.groupName=null;else if(t.term.length>0&&s!==t.term){i.$setViewValue(null);var a=function(e){s=t.term,n(e)};r.callAPI(e.getGroupList,{params:{query:t.term},successCallBack:a})}},d=function(e,t){return r.groupName=n.escapeNull(t.item.group_name),i.$setViewValue(angular.copy(t.item)),r.$emit("GROUP_SELECTED",t.item),c(),!1};r.groupName="",a.find("input").autocomplete({delay:r.delay?600:parseInt(r.delay),minLength:r.minLengthToTrigger?0:parseInt(r.minLengthToTrigger),position:{of:a.find("input"),my:"right top",at:"right bottom",collision:"flip",within:"body"},source:u,select:d}).data("ui-autocomplete")._renderItem=function(e,n){var r=angular.element("<a></a>"),a=angular.element("<span></span>",{class:"name",html:t(n.group_name,s)});return e.addClass("find-guest"),l=e,e.off("touchmove").on("touchmove",function(e){e.stopPropagation()}),r.append(a),angular.element("<li></li>").append(r).appendTo(e)},r.$on("$destroy",function(){a.find("input").autocomplete("destroy"),l instanceof HTMLElement&&l.off("touchmove")}),i.$render=function(){i.$viewValue||(r.groupName=null)}}}}]),angular.module("sntRover").directive("autoCompleteReservations",["RVSearchSrv","highlightFilter","rvUtilSrv",function(e,t,n){return{restrict:"A",require:"ngModel",templateUrl:"/assets/directives/autocomplete/rvAutoCompleteReservations/rvAutoCompleteReservations.html",link:function(r,a,o,i){BaseCtrl.call(this,r);var l=null,s="",c=function(){r.$$phase||r.$digest()},u=function(t,n){if(0===t.term.length)i.$setViewValue(null),r.guestName=null;else if(t.term.length>0&&s!==t.term){i.$setViewValue(null);var a=function(e){s=t.term,n(e)};r.callAPI(e.fetch,{params:{query:t.term,is_minimal:!0},successCallBack:a})}},d=function(e,t){return r.guestName=n.escapeNull(t.item.lastname)+", "+n.escapeNull(t.item.firstname),i.$setViewValue(angular.copy(t.item)),r.$emit("RESERVATION_SELECTED",t.item),c(),!1};r.guestName="",a.find("input").autocomplete({delay:r.delay?600:parseInt(r.delay),minLength:r.minLengthToTrigger?0:parseInt(r.minLengthToTrigger),position:{of:a.find("input"),my:"right top",at:"right bottom",collision:"flip",within:"body"},source:u,select:d}).data("ui-autocomplete")._renderItem=function(e,r){var a=angular.element("<a></a>"),o=r.images&&r.images.length>1?"guest-image accompany":"guest-image",i=angular.element("<figure></figure>",{class:o}),c=angular.element("<span></span>",{class:"name",html:t(n.escapeNull(r.lastname)+", "+n.escapeNull(r.firstname),s)}),u=angular.element("<span></span>",{class:"room",html:r.room?"Room "+t(r.room,s):""});return r.is_flagged&&i.addClass("blacklisted"),_.each(r.images,function(e){i.append(angular.element("<img>",{src:e.guest_image}))}),e.addClass("find-guest"),l=e,e.off("touchmove").on("touchmove",function(e){e.stopPropagation()}),i.append(angular.element("<img>")),a.append(i).append(c).append(u),angular.element("<li></li>").append(a).appendTo(e)},r.$on("$destroy",function(){a.find("input").autocomplete("destroy"),l instanceof HTMLElement&&l.off("touchmove")}),i.$render=function(){i.$viewValue||(r.guestName=null)}}}}]),sntRover.directive("autoComplete",["highlightFilter",function(e){return{restrict:"A",scope:{autoOptions:"=autoOptions",ngModel:"=",ulClass:"@ulClass",insertEmail:"=insertEmail"},link:function(t,n,r){var a=null;$(n).autocomplete(t.autoOptions).data("ui-autocomplete")._renderItem=function(n,r){n.addClass(t.ulClass),a=n,n.off("touchmove").on("touchmove",function(e){e.stopPropagation()});var o=e(r.label,t.ngModel),i=$("<a></a>").html(o),l="",s="",c="",u=null,d=null;switch(r.type){case"COMPANY":if(l="icon-company",i.addClass("autocomplete-result"),r.contract_access_code&&(u=e(r.contract_access_code,t.ngModel),d=$("<span></span>").html(u),d.addClass("icons icon-contracts access-code"),i.append(d)),""!==r.address){var f=$("<span></span>").html(r.address);f.addClass("location"),i.append(f)}break;case"ALLOTMENT":l="icon-allotment";break;case"TRAVELAGENT":if(l="icon-travel-agent",i.addClass("autocomplete-result"),r.contract_access_code&&(u=e(r.contract_access_code,t.ngModel),d=$("<span></span>").html(u),d.addClass("icons icon-contracts access-code"),i.append(d)),""!==r.address){var f=$("<span></span>").html(r.address);f.addClass("location"),i.append(f)}break;case"GROUP":l="icon-group",s="G";break;case"PROMO":l="icon-group-large",s="P"}return c=r.image?'<img  src="'+r.image+'" class="account-image icons">':'<span class="account-image icons '+l+'">'+s+"</span>",r.type&&$(c).prependTo(i),$("<li></li>").append(i).appendTo(n)},$(n).autocomplete("instance")._resizeMenu=function(){this.menu.element.css("height","auto"),$(n).offset().top-$(document).scrollTop()-this.menu.element.outerHeight()<=0&&this.menu.element.outerHeight($(n).offset().top-$(document).scrollTop()-10)};var o,i=function(e){var t=/\S+@\S+\.\S+/;return t.test(e)};t.insertEmail&&$(n).on("keypress",function(e){o=$(n).autocomplete("instance"),13===e.which&&(i(o.term)?(o.options.select(e,{item:{label:o.term,value:o.term}}),o.element.val("")):o.element.val(""))}),t.$on("$destroy",function(){$(n).autocomplete("destroy"),t.insertEmail&&$(n).off("keypress"),a instanceof HTMLElement&&a.off("touchmove")})}}}]),function(){var e=null,t=null,n=null,r=function(t,n){var r=e(t.name,n.ngModel),a=$("<a></a>").html(r);return a},a=function(e,a,o){$(a).autocomplete(e.autoOptions).data("ui-autocomplete")._renderItem=function(t,a){n=t,n.off("touchmove").on("touchmove",function(e){e.stopPropagation()});var o="";return t.addClass(e.ulClass),o=_.isFunction(e.processEachItem)?e.processEachItem(a,e):r(a,e),$("<li></li>").append(o).appendTo(t)},e.$on("$destroy",function(){t=$(a),t.autocomplete("destroy"),n instanceof HTMLElement&&n.off("touchmove")})};angular.module("sntRover").directive("roverAutoComplete",["highlightFilter",function(t){return e=t,{restrict:"A",scope:{autoOptions:"=autoCompleteOptions",ngModel:"=",ulClass:"@ulClass",processEachItem:"=processEachItem"},link:a}}])}(),function(){var e,t,n=null,r=function(r){BaseCtrl.call(this,r);var a,o=function(e,t){return 0===e.contract_rates.length?(r.$emit("showErrorMessage",["Unable find charge code against '"+r.rate_name+"'"]),void(r.rate_id="")):void t.callBackToAutoComplete(e.contract_rates)},i=function(t){var n={query:r.rate_name,account_id:r.account_id},a={params:n,successCallBack:o,successCallBackParameters:{callBackToAutoComplete:t}};r.callAPI(e.fetchRates,a)};r.clearConfigValues=function(){r.rate_id="",r.rate_name="",$(t).find("#company-rate-query").autocomplete("close")};var l=function(e,t){0===e.term.length?(r.clearConfigValues(),s()):e.term.length>a&&i(t)},s=function(){r.$$phase||r.$digest()},c=function(e,t){return r.rate_id=t.item.id,r.rate_name=t.item.name,r.$emit("RATE_SELECTED",t.item),s(),!1};r.processEachItem=function(e,t){var a=n(e.name,r.rate_name),o=$("<a></a>").html(a),i="",l="";switch(e.classification_name){case"SPECIALS":case"PUBLIC":i="Public";break;case"CORPORATE":i="Corporate"}return l='<span class="label '+i+'">'+i+"</span>",e.classification_name&&$(l).appendTo(o),o};(function(){r.rateAutocompleteOptions={delay:_.isUndefined(r.delay)?600:parseInt(r.delay),minLength:0,position:{my:"left top",at:"left bottom",collision:"flip"},source:l,select:c},setTimeout(function(){r.$apply(function(){r.label=_.isUndefined(r.label)?"Contracted Rate":r.label,r.entryDivClass=_.isUndefined(r.entryDivClass)?"find-rate margin":r.entryDivClass,a=_.isUndefined(r.minLengthToTrigger)?1:parseInt(r.minLengthToTrigger)})},100)})()};r.$inject=["$scope"];var a=function(e,n){t=n};angular.module("sntRover").directive("rateAutoComplete",["RVCompanyCardSrv","highlightFilter",function(t,o){return e=t,n=o,{restrict:"AE",replace:!0,scope:{rate_id:"=selectedRateId",rate_name:"=ngModel",label:"@label",entryDivClass:"@entryDivClass",delay:"@delay",minLengthToTrigger:"@minLengthToTrigger",account_id:"=accountId"},link:a,controller:r,templateUrl:"/assets/directives/rateAutoComplete/rateautocompletedir.html"}}])}(),sntRover.directive("rvDropdown",["$timeout",function(e){return{restrict:"AE",replace:"true",scope:{divStyle:"@divStyle",selboxStyle:"@selboxStyle",divClass:"@divClass",selboxClass:"@selboxClass",required:"@required",id:"@id",label:"@label",labelInDropDown:"@labelInDropDown",list:"=list",name:"@name",selectedId:"=selectedId"},templateUrl:"/assets/directives/selectBox/rvDropdownbox.html"}}]),sntRover.directive("rvSetTextboxValue",[function(){var e,t;return e={listenThis:"=listenThis"},t=function(e,t,n){var r=e.$watch("listenThis",function(n,r){"undefined"!=typeof e.listenThis&&null!==e.listenThis&&""!==e.listenThis.toString().trim()&&e.listenThis?t.val(n):t.val("")});e.$on("$destroy",r)},{restrict:"A",scope:e,link:t}}]),sntRover.directive("rvTextarea",["$timeout",function(e){var t;return{restrict:"E",replace:"true",scope:(t={value:"=value",name:"@name",label:"@label",placeholder:"@placeholder",required:"@required",id:"@id",divClass:"@divClass",textAreaClass:"@textAreaClass",rows:"@rows"},_defineProperty(t,"required","=required"),_defineProperty(t,"maxlength","@maxlength"),t),templateUrl:"/assets/directives/textArea/rvTextArea.html"}}]),sntRover.directive("forceDecimalZeroDir",["$timeout","$filter",function(e,t){return{restrict:"A",scope:{ngModel:"="},link:function(n,r){var a,o;o=function(e){a=t("number")(n.ngModel,2),r.val(a)},e(o,10,!1)}}}]),sntRover.directive("rvTextbox",["$timeout",function(e){return{restrict:"AE",replace:"true",scope:{value:"=value",name:"@name",label:"@label",placeholder:"@placeholder",required:"@required",id:"@id",styleclass:"@styleclass",inputtype:"@inputtype",readonly:"@readonly",maxlength:"@maxlength",disabled:"=disabled"},templateUrl:"/assets/directives/textBox/textboxDirective.html"}}]),sntRover.directive("imageLoad",function(){return{scope:{imageLoaded:"&"},link:function(e,t,n){t.bind("load",function(t){try{e.imageLoaded()}catch(e){}})}}}),sntRover.directive("rvToggleButton",["$timeout",function(e){return{restrict:"E",replace:"true",scope:_defineProperty({label:"@label",isChecked:"=isChecked",divClass:"@divClass"},"label","@label"),templateUrl:"/assets/directives/toggle/rvToggleButton.html"}}]),sntRover.directive("arTransactionPostChargeAutoComplete",["highlightFilter",function(e){return{restrict:"A",scope:{autoOptions:"=autoOptions",ngModel:"=",ulClass:"@ulClass",insertEmail:"=insertEmail"},link:function(t,n){var r=null;$(n).autocomplete(t.autoOptions).data("ui-autocomplete")._renderItem=function(n,a){n.addClass(t.ulClass),r=n,n.off("touchmove").on("touchmove",function(e){e.stopPropagation()});var o=e(a.label,t.ngModel),i=$("<a></a>").html(o),l="<span class='info'><span class='code'>"+a.charge_code+"</span><span class='price'><span class='currency'>"+a.curreny+"</span>"+a.unit_price+"</span></span>";return i.append(l),$("<li></li>").append(i).appendTo(n)},$(n).autocomplete("instance")._resizeMenu=function(){this.menu.element.css("height","auto"),$(n).offset().top-$(document).scrollTop()-this.menu.element.outerHeight()<=0&&this.menu.element.outerHeight($(n).offset().top-$(document).scrollTop()-10)}}}}]),function(){var e,t=this,n=null,r=function(r,a){BaseCtrl.call(t,r);var o=null,i=function(e,t){var a="";o=e,o.off("touchmove").on("touchmove",function(e){e.stopPropagation()}),e.addClass("find-cards");var i="",l="",s=$("<div></div>"),c=$("<span></span>").html(n(t.account_name,r.ngModel)),u=$("<span></span>").html(t.account_address),d=$("<span></span>").html("&nbsp;"),f=$("<br>");s.addClass("rates-box"),c.addClass("rate-data"),u.addClass("rate-data location"),f.attr("clear","all"),s.append(c).append(u).append(d).append(f);var a=$("<a></a>").html(s);switch(t.account_type){case"COMPANY":i="icon-company",s.addClass("dark");break;case"TRAVELAGENT":i="icon-travel-agent",s.addClass("purple");break;default:s.addClass("dark")}return l=t.company_logo?'<img src="'+t.company_logo+'" class="account-image icons">':'<span class="account-image icons '+i+'"></span>',t.account_type&&$(l).prependTo(a),$("<li></li>").append(a).appendTo(e)},l=function(e,t){t.callBackToAutoComplete(e.accounts)},s=function(t){var n={query:r.ngModel.trim()},a={params:n,successCallBack:l,successCallBackParameters:{callBackToAutoComplete:t}};r.callAPI(e.fetchCompanyCard,a)},c=function(){$(a).autocomplete("close")},u=function(e,t){0===e.term.length?(c(),d()):s(t)},d=function(){r.$$phase||r.$digest()},f=function(e,t){return d(),!1};r.$on("$destroy",function(){$(a).autocomplete("destroy"),o instanceof HTMLElement&&o.off("touchmove")}),function(){var e={of:a,my:"left top",at:"right top",collision:"fit",within:"body"};r.autocompleteOptions={source:u,delay:600,minLength:2,select:r.selectHandler?r.selectHandler:f,position:r.position?Object.assign(e,r.position):e,appendTo:r.appendTo?r.appendTo:"body"},$(a).autocomplete(r.autocompleteOptions).data("ui-autocomplete")._renderItem=i}()};angular.module("sntRover").directive("rvCcTaAutoComplete",["RMFilterOptionsSrv","highlightFilter",function(t,a){return e=t,n=a,{restrict:"A",scope:{ngModel:"=ngModel",selectHandler:"=selectHandler",position:"@position",appendTo:"@appendTo"},link:r}}])}(),sntRover.directive("overbookingAlert",function(){return{restrict:"AE",scope:{eventSourcesLeft:"=",eventSourcesRight:"=",leftCalendarOptions:"=",rightCalendarOptions:"=",nextButtonClickHandler:"&",prevButtonClickHandler:"&",disablePrevButton:"=disablePrevButton"},controller:["$scope","$compile","$http",function(e,t,n){e.nextButtonClicked=function(){e.nextButtonClickHandler()},e.prevButtonClicked=function(){e.prevButtonClickHandler()}}],templateUrl:"/assets/directives/overbookingAlert/rvOverbookingCalendar.html"}}),sntRover.directive("onetimemousemove",["$window",function(e){return{link:function(e,t){var n=$(t);n.on("mousemove",function(t){e.$emit("MOUSEMOVEDOVERME",t.target),e.$broadcast("MOUSEMOVEDOVERME",t.target),n.off("mousemove")})}}}]),angular.module("twoMonthscalendar",[]).directive("twoMonthCalendar",function(){return{restrict:"AE",scope:{eventSourcesLeft:"=",eventSourcesRight:"=",leftCalendarOptions:"=leftCalendarOptions",rightCalendarOptions:"=rightCalendarOptions",nextButtonClickHandler:"&",prevButtonClickHandler:"&",disablePrevButton:"=disablePrevButton"},controller:["$scope","$compile","$http",function(e,t,n){e.nextButtonClicked=function(){e.nextButtonClickHandler()},e.prevButtonClicked=function(){e.prevButtonClickHandler()}}],link:function(e,t,n,r){},templateUrl:"/assets/directives/fullCalendar/twoMonthCalendar.html"}}),angular.module("ngrepeatend",[]).directive("ngrepeatend",function(){return function(e,t,n){e.$last&&(e.$emit("NG_REPEAT_COMPLETED_RENDERING"),n.ngrepeatend&&e.$eval(n.ngrepeatend))}}),function(){angular.module("qtip3",[]).directive("qtipfc",["$timeout","$compile","$http","$templateCache",function(e,t,n,r){return{restrict:"A",scope:{qtipVisible:"=",qtipDisable:"=",qtipFixed:"=",qtipDelay:"=",qtipAdjustX:"=",qtipAdjustY:"=",qtip:"@",qtipTitle:"@",qtipContent:"@",qtipSelector:"@",qtipTemplate:"@",qtipEvent:"@",qtipEventOut:"@",qtipMy:"@",qtipAt:"@",object:"=qtipTemplateObject"},link:function(a,o,i){var l,s,c,u,d,f,p,v,g,h,m,y;y=function(e){var t;return!("false"===(t=String(e).toLowerCase())||"0"===t||"null"===t)},h=a.qtipMy||"bottom center",c=a.qtipAt||"top center",m=i.qtipClass||"qtip",l=parseInt(a.qtipAdjustX)||0,s=parseInt(a.qtipAdjustY)||0,u=a.qtipContent||a.qtip,f=a.qtipEvent||"mouseover",p=a.qtipEventOut||"mouseout",v=null===a.qtipFixed||y(a.qtipFixed),d=a.qtipDelay||100,g=function(e){var t;return t={content:e,position:{my:h,at:c,target:o,adjust:{x:l,y:s}},show:{event:f},hide:{fixed:v,delay:d,event:p},style:"qtip-snt"},$(o).qtip(t),i.qtipVisible&&a.$watch("qtipVisible",function(e){return $(o).qtip("toggle",e)}),i.qtipDisable&&a.$watch("qtipDisable",function(e){return $(o).qtip("disable",e)}),i.qtipTitle&&a.$watch("qtipTitle",function(e){return $(o).qtip("option","content.title",e)}),a.$watch("qtip",function(e,t){if(e!==t)return $(o).qtip("option","content.text",e)})},i.qtipSelector?e(function(){return g($(a.qtipSelector).html())},1):i.qtipTemplate?n.get(a.qtipTemplate,{cache:r}).then(function(e){return g({text:function(){return a.$apply(function(){return t(e.data)(a)})}})}):g(i.qtipTitle?{title:a.qtipTitle,text:a.qtip}:u),a.closeQtip=function(e){null!=e&&"function"==typeof e.preventDefault&&e.preventDefault(),$(".qtip:visible").qtip("hide")}}}}])}.call(void 0),angular.module("emitWhen",[]).directive("emitWhen",["$timeout",function(e){return{restrict:"A",link:function(t,n,r){var a=t.$eval(r.emitWhen),o=a.event,i=a.condition;i&&e(function(){t.$emit(o)})}}}]),angular.module("limitInputRange",[]).directive("limitInputRange",["$timeout",function(e){return{restrict:"A",require:"ngModel",link:function(e,t,n,r){var a,o,i,l=!1;return a=e.$eval(n.limitInputRange),a.hasOwnProperty("from")&&"number"!=typeof a.from?void console.error("'from' value should be numeric"):a.hasOwnProperty("to")&&"number"!=typeof a.to?void console.error("'to' value should be numeric"):a.hasOwnProperty("toFixed")&&"number"!=typeof a.toFixed?void console.error("'toFixed' value should be numeric"):(o=function(){var t=parseInt(r.$viewValue),n=t;isNaN(t)?n=a.hasOwnProperty("from")?a.from:"":a.hasOwnProperty("from")&&t<a.from?n=a.from:a.hasOwnProperty("to")&&t>a.to&&(n=a.to),(n||0===n)&&(n=a.hasOwnProperty("zeroPrefix")&&a.zeroPrefix&&n<10?"0"+n:a.hasOwnProperty("toFixed")?n.toFixed(a.toFixed):n.toString()),r.$setViewValue(n),r.$render(),e.$digest(),e[a.callback]&&e[a.callback](),e[a.onBlur]&&l&&e[a.onBlur]()},i=_.debounce(o,1e3),angular.element(t).on("keyup",i),angular.element(t).on("blur",function(){l=!0}),angular.element(t).on("focus",function(){l=!1}),void e.$on("$destroy",function(){angular.element(t).off("keyup"),angular.element(t).off("blur"),angular.element(t).off("focus")}))}}}]);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};sntRover.directive("multiOptionSelection",["$timeout",function(e){return{restrict:"E",templateUrl:"/assets/directives/multiOptionSelection/rvMultiOptionSelection.html",replace:!0,scope:{label:"@",onUpdate:"=",report:"=",data:"=",options:"=",affectsFilter:"=",displayStyle:"=",filterHolderObj:"="},controller:["$scope","$element","$attrs",function(t,n,r){function a(n,r){_.each(t.data,function(e){"function"==typeof r?r(e,n):e[n]=r}),e(t.onUpdate,150)}function o(){var n=t.options||{},r=_.where(t.data,{selected:!0});if(n.selectAll=!1,0===r.length?t.value=n.defaultValue||"Select "+t.label:1===r.length?t.value=r[0][n.key]||r[0][n.altKey]:r.length<t.data.length?t.value=r.length+" selected":r.length===t.data.length&&(n.selectAll=!0,t.value=n.allValue||"All Selected"),_typeof(t.affectsFilter)==_typeof({})){var a=t.report||t.filterHolderObj;a&&t.affectsFilter.process(a[t.affectsFilter.name],r)}e(t.onUpdate,150)}BaseCtrl.call(this,t),t.toggleView=function(n){t.closed=("undefined"==typeof n?"undefined":_typeof(n))===_typeof(!0)?n:!t.closed,e(t.onUpdate,150),t.$emit("report.details.filter.scroll.refresh")},t.clearSearch=function(){t.search="",t.onSearchChange()},t.onSearchChange=function(){a("filteredOut",function(e,n){var r=t.options||{},a=t.search.toLowerCase(),o=(e[r.key]||e[r.altKey]).toLowerCase();""===a||o.indexOf(a)>=0?e[n]=!1:e[n]=!0})},t.toggleSelectAll=function(){var e=t.options||{};e.selectAll=!e.selectAll,a("selected",e.selectAll),o()},t.toggleSelection=function(e){var n=t.options||{};e.selected=!e.selected;var r=function(){return e.selected&&!!n.singleSelect},a=function(){return e.selected&&n.selectiveSingleSelectKey===e.id},i=function(){return e.selected&&e.isRadioOption},l=function(){var e;n.selectiveSingleSelectKey&&(e=_.find(t.data,{id:n.selectiveSingleSelectKey}),e.selected=!1)},s=function(){_.each(t.data,function(t){t.id!==e.id&&(t.selected=!1)})},c=function(){_.each(t.data,function(t){t.isRadioOption&&t.id!==e.id&&(t.selected=!1)})};r()||a()?s():i()?c():l(),o()};var i=function(){t.closed=!0,t.value="";var e=t.options||{};e.selectAll&&a("selected",!0),e.hasSearch&&(t.search="",a("filteredOut",!1)),o()};i();var l=t.$watch("data",i),s=t.$watch("options",i);t.$on("$destroy",l),t.$on("$destroy",s),t.$on("FILTER_SELECTION_UPDATED",function(e){o()})}]}}]),angular.module("prettyTimeAgoModule",[]).factory("timeAgo",function(){return{convert:function(e){var t,n,r;return t=parseInt(e),isNaN(t)?"":(n=Math.floor(t/60),r=Math.floor(n/60),r>12?">12h":r>0?r+"h":n>0?n+"m":"1m")}}}).directive("prettyTimeAgo",["timeAgo",function(e){return{restrict:"A",replace:!1,scope:{prettyTimeAgo:"="},link:function(t,n){null===t.prettyTimeAgo&&void 0===t.prettyTimeAgo||n.html(e.convert(t.prettyTimeAgo))}}}]),angular.module("ui.calendar",[]).constant("uiCalendarConfig",{}).controller("uiCalendarCtrl",["$scope","$timeout",function(e,t){var n=1,r=1,a=e.eventSources,o=e.calendarWatchEvent?e.calendarWatchEvent:angular.noop,i=function(e){var n;return e&&(n=function(){var n=arguments;t(function(){e.apply(this,n)})}),n};this.eventsFingerprint=function(e){return e.__uiCalId||(e.__uiCalId=r++),""+e.__uiCalId+(e.id||"")+(e.title||"")+(e.url||"")+(+e.start||"")+(+e.end||"")+(e.allDay||"")+(e.className||"")+o(e)||""},this.sourcesFingerprint=function(e){return e.__id||(e.__id=n++)},this.allEvents=function(){for(var e=[],t=0,n=a.length;t<n;t++){var r=a[t];if(angular.isArray(r))e.push(r);else if(angular.isObject(r)&&angular.isArray(r.events)){var o={};for(var i in r)"_uiCalId"!==i&&"events"!==i&&(o[i]=r[i]);for(var l=0;l<r.events.length;l++)angular.extend(r.events[l],o);e.push(r.events)}}return Array.prototype.concat.apply([],e)},this.changeWatcher=function(e,t){var n,r=function(){for(var n,r,a=angular.isFunction(e)?e():e,i=[],l=0,s=a.length;l<s;l++)r=a[l],n=t(r),o[n]=r,i.push(n);return i},a=function(e,t){var n,r,a=[],o={};for(n=0,r=t.length;n<r;n++)o[t[n]]=!0;for(n=0,r=e.length;n<r;n++)o[e[n]]||a.push(e[n]);return a},o={},i=function(e,r){var i,l,s,c,u={},d=a(r,e);for(i=0,l=d.length;i<l;i++){var f=d[i];s=o[f],delete o[f];var p=t(s);p===f?n.onRemoved(s):(u[p]=f,n.onChanged(s))}var v=a(e,r);for(i=0,l=v.length;i<l;i++)c=v[i],s=o[c],u[c]||n.onAdded(s)};return n={subscribe:function(e,t){e.$watch(r,function(e,n){t&&t(e,n)===!1||i(e,n)},!0)},onAdded:angular.noop,onChanged:angular.noop,onRemoved:angular.noop}},this.getFullCalendarConfig=function(e,t){var n={};return angular.extend(n,t),angular.extend(n,e),angular.forEach(n,function(e,t){"function"==typeof e&&(n[t]=i(n[t]))}),n}}]).directive("uiCalendar",["uiCalendarConfig","$locale","$compile",function(e,t,n){var r=function(e){var t,n;t=[];for(n in e)t[n]=e[n];return t},a=t.DATETIME_FORMATS;return e=angular.extend({monthNames:r(a.MONTH),monthNamesShort:r(a.SHORTMONTH),dayNames:r(a.DAY),dayNamesShort:r(a.SHORTDAY)},e||{}),{restrict:"A",scope:{eventSources:"=ngModel",calendarWatchEvent:"&"},controller:"uiCalendarCtrl",link:function(t,r,a,o){function i(){var n,r=a.uiCalendar?t.$parent.$eval(a.uiCalendar):{};n=o.getFullCalendarConfig(r,e),d={eventSources:l},angular.extend(d,n);var i={};for(var s in d)"eventSources"!==s&&(i[s]=d[s]);return JSON.stringify(i)}var l=t.eventSources,s=!1,c=o.changeWatcher(l,o.sourcesFingerprint),u=o.changeWatcher(o.allEvents,o.eventsFingerprint),d=null;t.destroy=function(){a.calendar?t.calendar=t.$parent[a.calendar]=r.html(""):t.calendar=r.html("")},t.init=function(){d.compiler=n,d.compile_scope=t,t.calendar.fullCalendar(d)},c.onAdded=function(e){t.calendar.fullCalendar("addEventSource",e),s=!0},c.onRemoved=function(e){t.calendar.fullCalendar("removeEventSource",e),s=!0},u.onAdded=function(e){t.calendar.fullCalendar("renderEvent",e)},u.onRemoved=function(e){t.calendar.fullCalendar("removeEvents",function(t){return t===e})},u.onChanged=function(e){t.calendar.fullCalendar("updateEvent",e)},c.subscribe(t),u.subscribe(t,function(e,t){if(s===!0)return s=!1,!1}),t.$watch(i,function(e,n){t.destroy(),t.init()})}}}]);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){function n(t){e.extend(!0,Te,t)}function r(n,r,c){function u(e){ae?h()&&(E(),T(e)):d()}function d(){oe=r.theme?"ui":"fc",n.addClass("fc"),r.isRTL?n.addClass("fc-rtl"):n.addClass("fc-ltr"),r.theme&&n.addClass("ui-widget"),ae=e("<div class='fc-content' style='position:relative'/>").prependTo(n),ne=new a(te,r),re=ne.render(),re&&n.prepend(re),y(r.defaultView),r.handleWindowResize&&e(window).resize(M),m()||p()}function p(){setTimeout(function(){!ie.start&&m()&&D()},0)}function v(){ie&&(ee("viewDestroy",ie,ie,ie.element),ie.triggerEventDestroy()),e(window).unbind("resize",M),ne.destroy(),ae.remove(),n.removeClass("fc fc-rtl ui-widget")}function h(){return n.is(":visible")}function m(){return e("body").is(":visible")}function y(e){ie&&e==ie.name||b(e)}function b(t){ve++,ie&&(ee("viewDestroy",ie,ie,ie.element),U(),ie.triggerEventDestroy(),X(),ie.element.remove(),ne.deactivateButton(ie.name)),ne.activateButton(t),ie=new Se[t](e("<div class='fc-view fc-view-"+t+"' style='position:relative'/>").appendTo(ae),te),D(),Q(),ve--}function D(e){(!ie.start||e||ge<ie.start||ge>=ie.end)&&h()&&T(e)}function T(e){ve++,ie.start&&(ee("viewDestroy",ie,ie,ie.element),U(),O()),X(),ie.render(ge,e||0),S(),Q(),(ie.afterRender||k)(),P(),H(),ee("viewRender",ie,ie,ie.element),ie.trigger("viewDisplay",fe),ve--,L()}function w(){h()&&(U(),O(),E(),S(),F())}function E(){se=r.contentHeight?r.contentHeight:r.height?r.height-(re?re.height():0)-x(ae):Math.round(ae.width()/Math.max(r.aspectRatio,.5))}function S(){se===t&&E(),ve++,ie.setHeight(se),ie.setWidth(ae.width()),ve--,le=n.outerWidth()}function M(){if(!ve)if(ie.start){var e=++pe;setTimeout(function(){e==pe&&!ve&&h()&&le!=(le=n.outerWidth())&&(ve++,w(),ie.trigger("windowResize",fe),ve--)},200)}else p()}function A(){O(),R()}function $(e){O(),F(e)}function F(e){h()&&(ie.setEventData(he),ie.renderEvents(he,e),ie.trigger("eventAfterAllRender"))}function O(){ie.triggerEventDestroy(),ie.clearEvents(),ie.clearEventData()}function L(){!r.lazyFetching||ue(ie.visStart,ie.visEnd)?R():F()}function R(){de(ie.visStart,ie.visEnd)}function N(e){he=e,F()}function I(e){$(e)}function P(){ne.updateTitle(ie.title)}function H(){var e=new Date;e>=ie.start&&e<ie.end?ne.disableButton("today"):ne.enableButton("today")}function q(e,n,r){ie.select(e,n,r===t||r)}function U(){ie&&ie.unselect()}function B(){D(-1)}function W(){D(1)}function V(){i(ge,-1),D()}function z(){i(ge,1),D()}function j(){ge=new Date,D()}function G(e,t,n){e instanceof Date?ge=f(e):g(ge,e,t,n),D()}function Y(e,n,r){e!==t&&i(ge,e),n!==t&&l(ge,n),r!==t&&s(ge,r),D()}function J(){return f(ge)}function X(){ae.css({width:"100%",height:ae.height(),overflow:"hidden"})}function Q(){ae.css({width:"",height:"",overflow:""})}function K(){return ie}function Z(e,n){return n===t?r[e]:void("height"!=e&&"contentHeight"!=e&&"aspectRatio"!=e||(r[e]=n,w()))}function ee(e,t){if(r[e])return r[e].apply(t||fe,Array.prototype.slice.call(arguments,2))}var te=this;te.options=r,te.render=u,te.destroy=v,te.refetchEvents=A,te.reportEvents=N,te.reportEventChange=I,te.rerenderEvents=$,te.changeView=y,te.select=q,te.unselect=U,te.prev=B,te.next=W,te.prevYear=V,te.nextYear=z,te.today=j,te.gotoDate=G,te.incrementDate=Y,te.formatDate=function(e,t){return C(e,t,r)},te.formatDates=function(e,t,n){return _(e,t,n,r)},te.getDate=J,te.getView=K,te.option=Z,te.trigger=ee,o.call(te,r,c);var ne,re,ae,oe,ie,le,se,ce,ue=te.isFetchNeeded,de=te.fetchEvents,fe=n[0],pe=0,ve=0,ge=new Date,he=[];g(ge,r.year,r.month,r.date),r.droppable&&e(document).bind("dragstart",function(t,n){var a=t.target,o=e(a),i=r.dropAccept;(e.isFunction(i)?i.call(a,o):o.is(i))&&(ce=a,ie.dragStart(ce,t,n))}).bind("dragstop",function(e,t){ce&&(ie.dragStop(ce,e,t,r.nameID),ce=null)})}function a(t,n){function r(){f=n.theme?"ui":"fc";var t=n.header;if(t)return p=e("<table class='fc-header' style='width:100%'/>").append(e("<tr/>").append(o("left")).append(o("center")).append(o("right")));
}function a(){p.remove()}function o(r){var a=e("<td class='fc-header-"+r+"'/>"),o=n.header[r];return o&&e.each(o.split(" "),function(r){r>0&&a.append("<span class='fc-header-space'/>");var o;e.each(this.split(","),function(r,i){if("title"==i)a.append("<span class='fc-header-title'><h2>&nbsp;</h2></span>"),o&&o.addClass(f+"-corner-right"),o=null;else{var l;if(t[i]?l=t[i]:Se[i]&&(l=function(){u.removeClass(f+"-state-hover"),t.changeView(i)}),l){var s=n.theme?H(n.buttonIcons,i):null,c=H(n.buttonText,i),u=e("<span class='fc-button fc-button-"+i+" "+f+"-state-default'>"+(s?"<span class='fc-icon-wrap'><span class='ui-icon ui-icon-"+s+"'/></span>":c)+"</span>").click(function(){u.hasClass(f+"-state-disabled")||l()}).mousedown(function(){u.not("."+f+"-state-active").not("."+f+"-state-disabled").addClass(f+"-state-down")}).mouseup(function(){u.removeClass(f+"-state-down")}).hover(function(){u.not("."+f+"-state-active").not("."+f+"-state-disabled").addClass(f+"-state-hover")},function(){u.removeClass(f+"-state-hover").removeClass(f+"-state-down")}).appendTo(a);U(u),o||u.addClass(f+"-corner-left"),o=u}}}),o&&o.addClass(f+"-corner-right")}),a}function i(e){p.find("h2").html(e)}function l(e){p.find("span.fc-button-"+e).addClass(f+"-state-active")}function s(e){p.find("span.fc-button-"+e).removeClass(f+"-state-active")}function c(e){p.find("span.fc-button-"+e).addClass(f+"-state-disabled")}function u(e){p.find("span.fc-button-"+e).removeClass(f+"-state-disabled")}var d=this;d.render=r,d.destroy=a,d.updateTitle=i,d.activateButton=l,d.deactivateButton=s,d.disableButton=c,d.enableButton=u;var f,p=e([])}function o(n,r){function a(e,t){return!w||e<w||t>E}function o(e,t){w=e,E=t,R=[];var n=++x,r=F.length;O=r;for(var a=0;a<r;a++)i(F[a],n)}function i(t,r){l(t,function(a){if(r==x){if(a){n.eventDataTransform&&(a=e.map(a,n.eventDataTransform)),t.eventDataTransform&&(a=e.map(a,t.eventDataTransform));for(var o=0;o<a.length;o++)a[o].source=t,C(a[o]);R=R.concat(a)}O--,O||A(R)}})}function l(t,r){var a,o,i=Ee.sourceFetchers;for(a=0;a<i.length;a++){if(o=i[a](t,w,E,r),o===!0)return;if("object"==("undefined"==typeof o?"undefined":_typeof(o)))return void l(o,r)}var s=t.events;if(s)e.isFunction(s)?(m(),s(f(w),f(E),function(e){r(e),y()})):e.isArray(s)?r(s):r();else{var c=t.url;if(c){var u,d=t.success,p=t.error,v=t.complete;u=e.isFunction(t.data)?t.data():t.data;var g=e.extend({},u||{}),h=j(t.startParam,n.startParam),C=j(t.endParam,n.endParam);h&&(g[h]=Math.round(+w/1e3)),C&&(g[C]=Math.round(+E/1e3)),m(),e.ajax(e.extend({},Me,t,{data:g,success:function(t){t=t||[];var n=z(d,this,arguments);e.isArray(n)&&(t=n),r(t)},error:function(e,t,n){return"520"==e.status?(sntapp.activityIndicator.hideActivityIndicator(),void sntapp.showOWSErrorPopup()):"401"==e.status?void sntapp.logout():"501"==e.status||"502"==e.status||"503"==e.status||"504"==e.status?void(location.href=XHR_STATUS.INTERNAL_SERVER_ERROR):"404"==e.status?void(location.href=XHR_STATUS.SERVER_DOWN):(z(p,this,arguments),void r())},complete:function(){z(v,this,arguments),y()}}))}else r()}}function s(e){e=c(e),e&&(O++,i(e,x))}function c(t){if(e.isFunction(t)||e.isArray(t)?t={events:t}:"string"==typeof t&&(t={url:t}),"object"==("undefined"==typeof t?"undefined":_typeof(t)))return _(t),F.push(t),t}function u(t){F=e.grep(F,function(e){return!b(e,t)}),R=e.grep(R,function(e){return!b(e.source,t)}),A(R)}function d(e){var t,n,r=R.length,a=M().defaultEventEnd,o=e.start-e._start,i=e.end?e.end-(e._end||a(e)):0;for(t=0;t<r;t++)n=R[t],n._id==e._id&&n!=e&&(n.start=new Date(+n.start+o),e.end?n.end?n.end=new Date(+n.end+i):n.end=new Date(+a(n)+i):n.end=null,n.title=e.title,n.url=e.url,n.allDay=e.allDay,n.className=e.className,n.editable=e.editable,n.color=e.color,n.backgroundColor=e.backgroundColor,n.borderColor=e.borderColor,n.textColor=e.textColor,C(n));C(e),A(R)}function p(e,t,n){C(e),e.source||(t&&($.events.push(e),e.source=$),n&&R.push(e)),A(R)}function v(t){if(t){if(!e.isFunction(t)){var n=t+"";t=function(e){return e._id==n}}R=e.grep(R,t,!0);for(var r=0;r<F.length;r++)e.isArray(F[r].events)&&(F[r].events=e.grep(F[r].events,t,!0))}else{R=[];for(var r=0;r<F.length;r++)e.isArray(F[r].events)&&(F[r].events=[])}A(R)}function g(t){return e.isFunction(t)?e.grep(R,t):t?(t+="",e.grep(R,function(e){return e._id==t})):R}function m(){L++||S("loading",null,!0,M())}function y(){--L||S("loading",null,!1,M())}function C(e){var r=e.source||{},a=j(r.ignoreTimezone,n.ignoreTimezone);e._id=e._id||(e.id===t?"_fc"+Ae++:e.id+""),e.date&&(e.start||(e.start=e.date),delete e.date),e._start=f(e.start=h(e.start,a)),e.end=h(e.end,a),e.end&&e.end<=e.start&&(e.end=null),e._end=e.end?f(e.end):null,e.allDay===t&&(e.allDay=j(r.allDayDefault,n.allDayDefault)),e.className?"string"==typeof e.className&&(e.className=e.className.split(/\s+/)):e.className=[]}function _(e){e.className?"string"==typeof e.className&&(e.className=e.className.split(/\s+/)):e.className=[];for(var t=Ee.sourceNormalizers,n=0;n<t.length;n++)t[n](e)}function b(e,t){return e&&t&&D(e)==D(t)}function D(e){return("object"==("undefined"==typeof e?"undefined":_typeof(e))?e.events||e.url:"")||e}var T=this;T.isFetchNeeded=a,T.fetchEvents=o,T.addEventSource=s,T.removeEventSource=u,T.updateEvent=d,T.renderEvent=p,T.removeEvents=v,T.clientEvents=g,T.normalizeEvent=C;for(var w,E,S=T.trigger,M=T.getView,A=T.reportEvents,$={events:[]},F=[$],x=0,O=0,L=0,R=[],k=0;k<r.length;k++)c(r[k])}function i(e,t,n){return e.setFullYear(e.getFullYear()+t),n||d(e),e}function l(e,t,n){if(+e){var r=e.getMonth()+t,a=f(e);for(a.setDate(1),a.setMonth(r),e.setMonth(r),n||d(e);e.getMonth()!=a.getMonth();)e.setDate(e.getDate()+(e<a?1:-1))}return e}function s(e,t,n){if(+e){var r=e.getDate()+t,a=f(e);a.setHours(9),a.setDate(r),e.setDate(r),n||d(e),c(e,a)}return e}function c(e,t){if(+e)for(;e.getDate()!=t.getDate();)e.setTime(+e+(e<t?1:-1)*xe)}function u(e,t){return e.setMinutes(e.getMinutes()+t),e}function d(e){return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e}function f(e,t){return t?d(new Date((+e))):new Date((+e))}function p(){var e,t=0;do e=new Date(1970,(t++),1);while(e.getHours());return e}function v(e,t){return Math.round((f(e,!0)-f(t,!0))/Fe)}function g(e,n,r,a){n!==t&&n!=e.getFullYear()&&(e.setDate(1),e.setMonth(0),e.setFullYear(n)),r!==t&&r!=e.getMonth()&&(e.setDate(1),e.setMonth(r)),a!==t&&e.setDate(a)}function h(e,n){return"object"==("undefined"==typeof e?"undefined":_typeof(e))?e:"number"==typeof e?new Date(1e3*e):"string"==typeof e?e.match(/^\d+(\.\d+)?$/)?new Date(1e3*parseFloat(e)):(n===t&&(n=!0),m(e,n)||(e?new Date(e):null)):null}function m(e,t){var n=e.match(/^([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2})(:?([0-9]{2}))?))?)?)?)?$/);if(!n)return null;var r=new Date(n[1],0,1);if(t||!n[13]){var a=new Date(n[1],0,1,9,0);n[3]&&(r.setMonth(n[3]-1),a.setMonth(n[3]-1)),n[5]&&(r.setDate(n[5]),a.setDate(n[5])),c(r,a),n[7]&&r.setHours(n[7]),n[8]&&r.setMinutes(n[8]),n[10]&&r.setSeconds(n[10]),n[12]&&r.setMilliseconds(1e3*Number("0."+n[12])),c(r,a)}else if(r.setUTCFullYear(n[1],n[3]?n[3]-1:0,n[5]||1),r.setUTCHours(n[7]||0,n[8]||0,n[10]||0,n[12]?1e3*Number("0."+n[12]):0),n[14]){var o=60*Number(n[16])+(n[18]?Number(n[18]):0);o*="-"==n[15]?1:-1,r=new Date(+r+60*o*1e3)}return r}function y(e){if("number"==typeof e)return 60*e;if("object"==("undefined"==typeof e?"undefined":_typeof(e)))return 60*e.getHours()+e.getMinutes();var t=e.match(/(\d+)(?::(\d+))?\s*(\w+)?/);if(t){var n=parseInt(t[1],10);return t[3]&&(n%=12,"p"==t[3].toLowerCase().charAt(0)&&(n+=12)),60*n+(t[2]?parseInt(t[2],10):0)}}function C(e,t,n){return _(e,null,t,n)}function _(e,t,n,r){r=r||Te;var a,o,i,l,s=e,c=t,u=n.length,d="";for(a=0;a<u;a++)if(o=n.charAt(a),"'"==o){for(i=a+1;i<u;i++)if("'"==n.charAt(i)){s&&(d+=i==a+1?"'":n.substring(a+1,i),a=i);break}}else if("("==o){for(i=a+1;i<u;i++)if(")"==n.charAt(i)){var f=C(s,n.substring(a+1,i),r);parseInt(f.replace(/\D/,""),10)&&(d+=f),a=i;break}}else if("["==o){for(i=a+1;i<u;i++)if("]"==n.charAt(i)){var p=n.substring(a+1,i),f=C(s,p,r);f!=C(c,p,r)&&(d+=f),a=i;break}}else if("{"==o)s=t,c=e;else if("}"==o)s=e,c=t;else{for(i=u;i>a;i--)if(l=Le[n.substring(a,i)]){s&&(d+=l(s,r)),a=i-1;break}i==a&&s&&(d+=o)}return d}function b(e){var t,n=new Date(e.getTime());return n.setDate(n.getDate()+4-(n.getDay()||7)),t=n.getTime(),n.setMonth(0),n.setDate(1),Math.floor(Math.round((t-n)/864e5)/7)+1}function D(e){return e.end?T(e.end,e.allDay):s(f(e.start),1)}function T(e,t){return e=f(e),t||e.getHours()||e.getMinutes()?s(e,1):d(e)}function w(n,r,a){n.unbind("mouseover").mouseover(function(n){for(var o,i,l,s=n.target;s!=this;)o=s,s=s.parentNode;(i=o._fci)!==t&&(o._fci=t,l=r[i],a(l.event,l.element,l),e(n.target).trigger(n)),n.stopPropagation()})}function E(t,n,r){for(var a,o=0;o<t.length;o++)a=e(t[o]),a.width(Math.max(0,n-M(a,r)))}function S(t,n,r){for(var a,o=0;o<t.length;o++)a=e(t[o]),a.height(Math.max(0,n-x(a,r)))}function M(e,t){return A(e)+F(e)+(t?$(e):0)}function A(t){return(parseFloat(e.css(t[0],"paddingLeft",!0))||0)+(parseFloat(e.css(t[0],"paddingRight",!0))||0)}function $(t){return(parseFloat(e.css(t[0],"marginLeft",!0))||0)+(parseFloat(e.css(t[0],"marginRight",!0))||0)}function F(t){return(parseFloat(e.css(t[0],"borderLeftWidth",!0))||0)+(parseFloat(e.css(t[0],"borderRightWidth",!0))||0)}function x(e,t){return O(e)+R(e)+(t?L(e):0)}function O(t){return(parseFloat(e.css(t[0],"paddingTop",!0))||0)+(parseFloat(e.css(t[0],"paddingBottom",!0))||0)}function L(t){return(parseFloat(e.css(t[0],"marginTop",!0))||0)+(parseFloat(e.css(t[0],"marginBottom",!0))||0)}function R(t){return(parseFloat(e.css(t[0],"borderTopWidth",!0))||0)+(parseFloat(e.css(t[0],"borderBottomWidth",!0))||0)}function k(){}function N(e,t){return e-t}function I(e){return Math.max.apply(Math,e)}function P(e){return(e<10?"0":"")+e}function H(e,n){if(e[n]!==t)return e[n];for(var r,a=n.split(/(?=[A-Z])/),o=a.length-1;o>=0;o--)if(r=e[a[o].toLowerCase()],r!==t)return r;return e[""]}function q(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />")}function U(e){e.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function B(e){e.children().removeClass("fc-first fc-last").filter(":first-child").addClass("fc-first").end().filter(":last-child").addClass("fc-last")}function W(e,t){var n=e.source||{},r=e.color,a=n.color,o=t("eventColor"),i=e.backgroundColor||r||n.backgroundColor||a||t("eventBackgroundColor")||o,l=e.borderColor||r||n.borderColor||a||t("eventBorderColor")||o,s=e.textColor||n.textColor||t("eventTextColor"),c=[];return i&&c.push("background-color:"+i),l&&c.push("border-color:"+l),s&&c.push("color:"+s),c.join(";")}function V(e){var t={};return"left"!==e.event.currentCalendar||0!==e.leftCol&&1!==e.leftCol?"right"!==e.event.currentCalendar||5!==e.leftCol&&6!==e.leftCol?(t.at="top center",t.my="bottom center",t.position="center"):(t.at="top center",t.my="bottom right",t.position="right"):(t.at="top center",t.my="bottom left",t.position="left"),t}function z(t,n,r){if(e.isFunction(t)&&(t=[t]),t){var a,o;for(a=0;a<t.length;a++)o=t[a].apply(n,r)||o;return o}}function j(){for(var e=0;e<arguments.length;e++)if(arguments[e]!==t)return arguments[e]}function G(e,t){function n(e,t){t&&(l(e,t),e.setDate(1));var n=a("firstDay"),d=f(e,!0);d.setDate(1);var p=l(f(d),1),g=f(d);s(g,-((g.getDay()-n+7)%7)),i(g);var h=f(p);s(h,(7-h.getDay()+n)%7),i(h,-1,!0);var m=c(),y=Math.round(v(h,g)/7);"fixed"==a("weekMode")&&(s(h,7*(6-y)),y=6),r.title=u(d,a("titleFormat")),r.start=d,r.end=p,r.visStart=g,r.visEnd=h,o(y,m,!0)}var r=this;r.render=n,X.call(r,e,t,"month");var a=r.opt,o=r.renderBasic,i=r.skipHiddenDays,c=r.getCellsPerWeek,u=t.formatDate}function Y(e,t){function n(e,t){t&&s(e,7*t);var n=s(f(e),-((e.getDay()-a("firstDay")+7)%7)),u=s(f(n),7),d=f(n);i(d);var p=f(u);i(p,-1,!0);var v=l();r.start=n,r.end=u,r.visStart=d,r.visEnd=p,r.title=c(d,s(f(p),-1),a("titleFormat")),o(1,v,!1)}var r=this;r.render=n,X.call(r,e,t,"basicWeek");var a=r.opt,o=r.renderBasic,i=r.skipHiddenDays,l=r.getCellsPerWeek,c=t.formatDates}function J(e,t){function n(e,t){t&&s(e,t),i(e,t<0?-1:1);var n=f(e,!0),c=s(f(n),1);r.title=l(e,a("titleFormat")),r.start=r.visStart=n,r.end=r.visEnd=c,o(1,1,!1)}var r=this;r.render=n,X.call(r,e,t,"basicDay");var a=r.opt,o=r.renderBasic,i=r.skipHiddenDays,l=t.formatDate}function X(t,n,r){function a(e,t,n){te=e,ne=t,re=n,o(),W||i(),l()}function o(){se=ve("theme")?"ui":"fc",ce=ve("columnFormat"),ue=ve("weekNumbers"),de=ve("weekNumberTitle"),pe="iso"!=ve("weekNumberCalculation")?"w":"W"}function i(){J=e("<div class='fc-event-container' style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(t)}function l(){var n=c();I&&I.remove(),I=e(n).appendTo(t),P=I.find("thead"),H=P.find(".fc-day-header"),W=I.find("tbody"),V=W.find("tr"),z=W.find(".fc-day"),j=V.find("td:first-child"),G=V.eq(0).find(".fc-day > div"),Y=V.eq(0).find(".fc-day-content > div"),B(P.add(P.find("tr"))),B(V),V.eq(0).addClass("fc-first"),V.filter(":last").addClass("fc-last"),z.each(function(t,n){var r=we(Math.floor(t/ne),t%ne);ge("dayRender",N,r,e(n))}),y(z)}function c(){var e="<table class='fc-border-separate' style='width:100%' cellspacing='0'>"+u()+p()+"</table>";return e}function u(){var e,t,n=se+"-widget-header",r="";for(r+="<thead><tr>",ue&&(r+="<th class='fc-week-number "+n+"'>"+q(de)+"</th>"),e=0;e<ne;e++)t=we(0,e),r+="<th class='fc-day-header fc-"+$e[t.getDay()]+" "+n+"'>"+q(Me(t,ce))+"</th>";return r+="</tr></thead>"}function p(){var e,t,n,r=se+"-widget-content",a="";for(a+="<tbody>",e=0;e<te;e++){for(a+="<tr class='fc-week'>",ue&&(n=we(e,0),a+="<td class='fc-week-number "+r+"'><div>"+q(Me(n,pe))+"</div></td>"),t=0;t<ne;t++)n=we(e,t),a+=v(n);a+="</tr>"}return a+="</tbody>"}function v(e){var t=se+"-widget-content",n=N.start.getMonth(),r=d(new Date),a="",o=["fc-day","fc-"+$e[e.getDay()],t];return e.getMonth()!=n&&o.push("fc-other-month"),+e==+r?o.push("fc-today",se+"-state-highlight"):e<r?o.push("fc-past"):o.push("fc-future"),a+="<td class='"+o.join(" ")+"' data-date='"+Me(e,"yyyy-MM-dd")+"'><div>",re&&(a+="<div class='fc-day-number'>"+e.getDate()+"</div>"),a+="<div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>"}function g(t){K=t;var n,r,a,o=K-P.height();"variable"==ve("weekMode")?n=r=Math.floor(o/(1==te?2:6)):(n=Math.floor(o/te),r=o-n*(te-1)),j.each(function(t,o){t<te&&(a=e(o),a.find("> div").css("min-height",(t==te-1?r:n)-x(a)))})}function h(e){X=e,ie.clear(),le.clear(),ee=0,ue&&(ee=P.find("th.fc-week-number").outerWidth()),Z=Math.floor((X-ee)/ne),E(H.slice(0,-1),Z)}function y(e){e.click(C).mousedown(Te)}function C(t){if(!ve("selectable")){var n=m(e(this).data("date"));ge("dayClick",this,n,!0,t)}}function _(e,t,n){n&&ae.build();for(var r=Se(e,t),a=0;a<r.length;a++){var o=r[a];y(b(o.row,o.leftCol,o.row,o.rightCol))}}function b(e,n,r,a){var o=ae.rect(e,n,r,a,t);return he(o,t)}function D(e,t){return f(e)}function T(e,t,n){_(e,s(f(t),1),!0)}function w(){be()}function S(e,t,n){var r=Ee(e),a=z[r.row*ne+r.col];ge("dayClick",a,e,t,n)}function M(e,t,n){oe.start(function(e){be(),e&&b(e.row,e.col,e.row,e.col)},t)}function A(e,t,n,r){var a=oe.stop();if(be(),a){var o=we(a);ge("drop",e,o,!0,t,n,r)}}function $(e){return f(e.start)}function F(e){return ie.left(e)}function O(e){return ie.right(e)}function L(e){return le.left(e)}function R(e){return le.right(e)}function k(e){return V.eq(e)}var N=this;N.renderBasic=a,N.setHeight=g,N.setWidth=h,N.renderDayOverlay=_,N.defaultSelectionEnd=D,N.renderSelection=T,N.clearSelection=w,N.reportDayClick=S,N.dragStart=M,N.dragStop=A,N.defaultEventEnd=$,N.getHoverListener=function(){return oe},N.colLeft=F,N.colRight=O,N.colContentLeft=L,N.colContentRight=R,N.getIsCellAllDay=function(){return!0},N.allDayRow=k,N.getRowCnt=function(){return te},N.getColCnt=function(){return ne},N.getColWidth=function(){return Z},N.getDaySegmentContainer=function(){return J},fe.call(N,t,n,r),ye.call(N),me.call(N),Q.call(N);var I,P,H,W,V,z,j,G,Y,J,X,K,Z,ee,te,ne,re,ae,oe,ie,le,se,ce,ue,de,pe,ve=N.opt,ge=N.trigger,he=N.renderOverlay,be=N.clearOverlays,Te=N.daySelectionMousedown,we=N.cellToDate,Ee=N.dateToCell,Se=N.rangeToSegments,Me=n.formatDate;U(t.addClass("fc-grid")),ae=new Ce(function(t,n){var r,a,o;H.each(function(t,i){r=e(i),a=r.offset().left,t&&(o[1]=a),o=[a],n[t]=o}),o[1]=a+r.outerWidth(),V.each(function(n,i){n<te&&(r=e(i),a=r.offset().top,n&&(o[1]=a),o=[a],t[n]=o)}),o[1]=a+r.outerHeight()}),oe=new _e(ae),ie=new De(function(e){return G.eq(e)}),le=new De(function(e){return Y.eq(e)})}function Q(){function e(e,t){n.renderDayEvents(e,t)}function t(){n.getDaySegmentContainer().empty()}var n=this;n.renderEvents=e,n.clearEvents=t,pe.call(n)}function K(e,t){function n(e,t){t&&s(e,7*t);var n=s(f(e),-((e.getDay()-a("firstDay")+7)%7)),u=s(f(n),7),d=f(n);i(d);var p=f(u);i(p,-1,!0);var v=l();r.title=c(d,s(f(p),-1),a("titleFormat")),r.start=n,r.end=u,r.visStart=d,r.visEnd=p,o(v)}var r=this;r.render=n,ee.call(r,e,t,"agendaWeek");var a=r.opt,o=r.renderAgenda,i=r.skipHiddenDays,l=r.getCellsPerWeek,c=t.formatDates}function Z(e,t){function n(e,t){t&&s(e,t),i(e,t<0?-1:1);var n=f(e,!0),c=s(f(n),1);r.title=l(e,a("titleFormat")),r.start=r.visStart=n,r.end=r.visEnd=c,o(1)}var r=this;r.render=n,ee.call(r,e,t,"agendaDay");var a=r.opt,o=r.renderAgenda,i=r.skipHiddenDays,l=t.formatDate}function ee(n,r,a){function o(e){Re=e,i(),Z?c():l()}function i(){qe=Ye("theme")?"ui":"fc",Ue=Ye("isRTL"),Be=y(Ye("minTime")),We=y(Ye("maxTime")),Ve=Ye("columnFormat"),ze=Ye("weekNumbers"),je=Ye("weekNumberTitle"),Ge="iso"!=Ye("weekNumberCalculation")?"w":"W",xe=Ye("snapMinutes")||Ye("slotMinutes")}function l(){var t,r,a,o,i,l=qe+"-widget-header",s=qe+"-widget-content",d=Ye("slotMinutes")%15==0;for(c(),ce=e("<div style='position:absolute;z-index:2;left:0;width:100%'/>").appendTo(n),Ye("allDaySlot")?(ue=e("<div class='fc-event-container' style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(ce),t="<table style='width:100%' class='fc-agenda-allday' cellspacing='0'><tr><th class='"+l+" fc-agenda-axis'>"+Ye("allDayText")+"</th><td><div class='fc-day-content'><div style='position:relative'/></div></td><th class='"+l+" fc-agenda-gutter'>&nbsp;</th></tr></table>",de=e(t).appendTo(ce),pe=de.find("tr"),D(pe.find("td")),ce.append("<div class='fc-agenda-divider "+l+"'><div class='fc-agenda-divider-inner'/></div>")):ue=e([]),ve=e("<div style='position:absolute;width:100%;overflow-x:hidden;overflow-y:auto'/>").appendTo(ce),ge=e("<div style='position:relative;width:100%;overflow:hidden'/>").appendTo(ve),he=e("<div class='fc-event-container' style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(ge),t="<table class='fc-agenda-slots' style='width:100%' cellspacing='0'><tbody>",r=p(),o=u(f(r),We),u(r,Be),ke=0,a=0;r<o;a++)i=r.getMinutes(),t+="<tr class='fc-slot"+a+" "+(i?"fc-minor":"")+"'><th class='fc-agenda-axis "+l+"'>"+(d&&i?"&nbsp;":ot(r,Ye("axisFormat")))+"</th><td class='"+s+"'><div style='position:relative'>&nbsp;</div></td></tr>",u(r,Ye("slotMinutes")),ke++;t+="</tbody></table>",be=e(t).appendTo(ge),T(be.find("td"))}function c(){var t=v();Z&&Z.remove(),Z=e(t).appendTo(n),ee=Z.find("thead"),ne=ee.find("th").slice(1,-1),re=Z.find("tbody"),ae=re.find("td").slice(0,-1),oe=ae.find("> div"),ie=ae.find(".fc-day-content > div"),le=ae.eq(0),se=oe.eq(0),B(ee.add(ee.find("tr"))),B(re.add(re.find("tr")))}function v(){var e="<table style='width:100%' class='fc-agenda-days fc-border-separate' cellspacing='0'>"+g()+h()+"</table>";return e}function g(){var e,t,n,r=qe+"-widget-header",a="";for(a+="<thead><tr>",ze?(e=nt(0,0),t=ot(e,Ge),Ue?t+=je:t=je+t,a+="<th class='fc-agenda-axis fc-week-number "+r+"'>"+q(t)+"</th>"):a+="<th class='fc-agenda-axis "+r+"'>&nbsp;</th>",n=0;n<Re;n++)e=nt(0,n),a+="<th class='fc-"+$e[e.getDay()]+" fc-col"+n+" "+r+"'>"+q(ot(e,Ve))+"</th>";return a+="<th class='fc-agenda-gutter "+r+"'>&nbsp;</th></tr></thead>"}function h(){var e,t,n,r,a,o=qe+"-widget-header",i=qe+"-widget-content",l=d(new Date),s="";for(s+="<tbody><tr><th class='fc-agenda-axis "+o+"'>&nbsp;</th>",n="",t=0;t<Re;t++)e=nt(0,t),a=["fc-col"+t,"fc-"+$e[e.getDay()],i],+e==+l?a.push(qe+"-state-highlight","fc-today"):e<l?a.push("fc-past"):a.push("fc-future"),r="<td class='"+a.join(" ")+"'><div><div class='fc-day-content'><div style='position:relative'>&nbsp;</div></div></div></td>",n+=r;return s+=n,s+="<td class='fc-agenda-gutter "+i+"'>&nbsp;</td></tr></tbody>"}function m(e){e===t&&(e=Ee),Ee=e,it={};var n=re.position().top,r=ve.position().top,a=Math.min(e-n,be.height()+r+1);se.height(a-x(le)),ce.css("top",n),ve.height(a-r-1),Fe=be.find("tr:first").height()+1,Oe=Ye("slotMinutes")/xe,Le=Fe/Oe}function C(t){we=t,Pe.clear(),He.clear();var n=ee.find("th:first");de&&(n=n.add(de.find("th:first"))),n=n.add(be.find("th:first")),Se=0,E(n.width("").each(function(t,n){Se=Math.max(Se,e(n).outerWidth())}),Se);var r=Z.find(".fc-agenda-gutter");de&&(r=r.add(de.find("th.fc-agenda-gutter")));var a=ve[0].clientWidth;Ae=ve.width()-a,Ae?(E(r,Ae),r.show().prev().removeClass("fc-last")):r.hide().prev().addClass("fc-last"),Me=Math.floor((a-Se)/Re),E(ne.slice(0,-1),Me)}function _(){function e(){ve.scrollTop(r)}var t=p(),n=f(t);n.setHours(Ye("firstHour"));var r=P(t,n)+1;e(),setTimeout(e,0)}function b(){_()}function D(e){e.click(w).mousedown(et)}function T(e){e.click(w).mousedown(Y)}function w(e){if(!Ye("selectable")){var t=Math.min(Re-1,Math.floor((e.pageX-Z.offset().left-Se)/Me)),n=nt(0,t),r=this.parentNode.className.match(/fc-slot(\d+)/);if(r){var a=parseInt(r[1])*Ye("slotMinutes"),o=Math.floor(a/60);n.setHours(o),n.setMinutes(a%60+Be),Je("dayClick",ae[t],n,!1,e)}else Je("dayClick",ae[t],n,!0,e)}}function M(e,t,n){n&&Ne.build();for(var r=at(e,t),a=0;a<r.length;a++){var o=r[a];D(A(o.row,o.leftCol,o.row,o.rightCol))}}function A(e,t,n,r){var a=Ne.rect(e,t,n,r,ce);return Xe(a,ce)}function $(e,t){for(var n=0;n<Re;n++){var r=nt(0,n),a=s(f(r),1),o=new Date(Math.max(r,e)),i=new Date(Math.min(a,t));if(o<i){var l=Ne.rect(0,n,0,n,ge),c=P(r,o),u=P(r,i);l.top=c,l.height=u-c,T(Xe(l,ge))}}}function F(e){return Pe.left(e)}function O(e){return He.left(e)}function L(e){return Pe.right(e)}function R(e){return He.right(e)}function k(e){return Ye("allDaySlot")&&!e.row}function I(e){var t=nt(0,e.col),n=e.row;return Ye("allDaySlot")&&n--,n>=0&&u(t,Be+n*xe),t}function P(e,n){if(e=f(e,!0),n<u(f(e),Be))return 0;if(n>=u(f(e),We))return be.height();var r=Ye("slotMinutes"),a=60*n.getHours()+n.getMinutes()-Be,o=Math.floor(a/r),i=it[o];return i===t&&(i=it[o]=be.find("tr").eq(o).find("td div")[0].offsetTop),Math.max(0,Math.round(i-1+Fe*(a%r/r)))}function H(e){return pe}function W(e){var t=f(e.start);return e.allDay?t:u(t,Ye("defaultEventMinutes"))}function V(e,t){return t?f(e):u(f(e),Ye("slotMinutes"))}function z(e,t,n){n?Ye("allDaySlot")&&M(e,s(f(t),1),!0):j(e,t)}function j(t,n){var r=Ye("selectHelper");if(Ne.build(),r){var a=rt(t).col;if(a>=0&&a<Re){var o=Ne.rect(0,a,0,a,ge),i=P(t,t),l=P(t,n);if(l>i){if(o.top=i,o.height=l-i,o.left+=2,o.width-=5,e.isFunction(r)){var s=r(t,n);s&&(o.position="absolute",Te=e(s).css(o).appendTo(ge))}else o.isStart=!0,o.isEnd=!0,Te=e(tt({title:"",start:t,end:n,className:["fc-select-helper"],editable:!1},o)),Te.css("opacity",Ye("dragOpacity"));Te&&(T(Te),ge.append(Te),E(Te,o.width,!0),S(Te,o.height,!0))}}}else $(t,n)}function G(){Qe(),Te&&(Te.remove(),Te=null)}function Y(t){if(1==t.which&&Ye("selectable")){Ze(t);var n;Ie.start(function(e,t){if(G(),e&&e.col==t.col&&!k(e)){var r=I(t),a=I(e);n=[r,u(f(r),xe),a,u(f(a),xe)].sort(N),j(n[0],n[3])}else n=null},t),e(document).one("mouseup",function(e){Ie.stop(),n&&(+n[0]==+n[1]&&J(n[0],!1,e),Ke(n[0],n[3],!1,e))})}}function J(e,t,n){Je("dayClick",ae[rt(e).col],e,t,n)}function X(e,t,n){Ie.start(function(e){if(Qe(),e)if(k(e))A(e.row,e.col,e.row,e.col);else{var t=I(e),n=u(f(t),Ye("defaultEventMinutes"));$(t,n)}},t)}function Q(e,t,n){var r=Ie.stop();Qe(),r&&Je("drop",e,I(r),k(r),t,n)}var K=this;K.renderAgenda=o,K.setWidth=C,K.setHeight=m,K.afterRender=b,K.defaultEventEnd=W,K.timePosition=P,K.getIsCellAllDay=k,K.allDayRow=H,K.getCoordinateGrid=function(){return Ne},K.getHoverListener=function(){return Ie},K.colLeft=F,K.colRight=L,K.colContentLeft=O,K.colContentRight=R,K.getDaySegmentContainer=function(){return ue},K.getSlotSegmentContainer=function(){return he},K.getMinMinute=function(){return Be},K.getMaxMinute=function(){return We},K.getSlotContainer=function(){return ge},K.getRowCnt=function(){return 1},K.getColCnt=function(){return Re},K.getColWidth=function(){return Me},K.getSnapHeight=function(){return Le},K.getSnapMinutes=function(){return xe},K.defaultSelectionEnd=V,K.renderDayOverlay=M,K.renderSelection=z,K.clearSelection=G,K.reportDayClick=J,K.dragStart=X,K.dragStop=Q,fe.call(K,n,r,a),ye.call(K),me.call(K),te.call(K);var Z,ee,ne,re,ae,oe,ie,le,se,ce,ue,de,pe,ve,ge,he,be,Te,we,Ee,Se,Me,Ae,Fe,xe,Oe,Le,Re,ke,Ne,Ie,Pe,He,qe,Ue,Be,We,Ve,ze,je,Ge,Ye=K.opt,Je=K.trigger,Xe=K.renderOverlay,Qe=K.clearOverlays,Ke=K.reportSelection,Ze=K.unselect,et=K.daySelectionMousedown,tt=K.slotSegHtml,nt=K.cellToDate,rt=K.dateToCell,at=K.rangeToSegments,ot=r.formatDate,it={};U(n.addClass("fc-agenda")),Ne=new Ce(function(t,n){function r(e){return Math.max(s,Math.min(c,e))}var a,o,i;ne.each(function(t,r){a=e(r),o=a.offset().left,t&&(i[1]=o),i=[o],n[t]=i}),i[1]=o+a.outerWidth(),Ye("allDaySlot")&&(a=pe,o=a.offset().top,t[0]=[o,o+a.outerHeight()]);for(var l=ge.offset().top,s=ve.offset().top,c=s+ve.outerHeight(),u=0;u<ke*Oe;u++)t.push([r(l+Le*u),r(l+Le*(u+1))])}),Ie=new _e(Ne),Pe=new De(function(e){return oe.eq(e)}),He=new De(function(e){return ie.eq(e)})}function te(){function n(e,t){var n,r=e.length,o=[],i=[];for(n=0;n<r;n++)e[n].allDay?o.push(e[n]):i.push(e[n]);y("allDaySlot")&&(ee(o,t),A()),l(a(i),t)}function r(){$().empty(),F().empty()}function a(t){var n,r,a,l,s,c=U(),d=R(),p=L(),v=e.map(t,i),g=[];for(r=0;r<c;r++)for(n=H(0,r),u(n,d),s=o(t,v,n,u(f(n),p-d)),s=ne(s),a=0;a<s.length;a++)l=s[a],l.col=r,g.push(l);return g}function o(e,t,n,r){var a,o,i,l,s,c,u,d,p=[],v=e.length;for(a=0;a<v;a++)o=e[a],i=o.start,l=t[a],l>n&&i<r&&(i<n?(s=f(n),u=!1):(s=i,u=!0),l>r?(c=f(r),d=!1):(c=l,d=!0),p.push({event:o,start:s,end:c,isStart:u,isEnd:d}));return p.sort(de)}function i(e){return e.end?f(e.end):u(f(e.start),y("defaultEventMinutes"))}function l(n,r){var a,o,i,l,s,u,f,p,v,g,h,m,_,b,D,T,E=n.length,S="",A=F(),$=y("isRTL");for(a=0;a<E;a++)o=n[a],i=o.event,l=k(o.start,o.start),s=k(o.start,o.end),u=I(o.col),f=P(o.col),p=f-u,f-=.025*p,p=f-u,v=p*(o.forwardCoord-o.backwardCoord),y("slotEventOverlap")&&(v=Math.max(2*(v-10),v)),$?(h=f-o.backwardCoord*p,g=h-v):(g=u+o.backwardCoord*p,h=g+v),g=Math.max(g,u),h=Math.min(h,f),v=h-g,o.top=l,o.left=g,o.outerWidth=v,o.outerHeight=s-l,S+=c(i,o);for(A[0].innerHTML=S,m=A.children(),a=0;a<E;a++)o=n[a],i=o.event,_=e(m[a]),b=C("eventRender",i,i,_),b===!1?_.remove():(b&&b!==!0&&(_.remove(),_=e(b).css({position:"absolute",top:o.top,left:o.left}).appendTo(A)),o.element=_,i._id===r?d(i,_,o):_[0]._fci=a,G(i,_));for(w(A,n,d),a=0;a<E;a++)o=n[a],(_=o.element)&&(o.vsides=x(_,!0),o.hsides=M(_,!0),D=_.find(".fc-event-title"),D.length&&(o.contentTop=D[0].offsetTop));for(a=0;a<E;a++)o=n[a],(_=o.element)&&(_[0].style.width=Math.max(0,o.outerWidth-o.hsides)+"px",T=Math.max(0,o.outerHeight-o.vsides),_[0].style.height=T+"px",i=o.event,o.contentTop!==t&&T-o.contentTop<10&&(_.find("div.fc-event-time").text(re(i.start,y("timeFormat"))+" - "+i.title),_.find("div.fc-event-title").remove()),C("eventAfterRender",i,i,_))}function c(e,t){var n="<",r=e.url,a=W(e,y),o=["fc-event","fc-event-vert"];return _(e)&&o.push("fc-event-draggable"),t.isStart&&o.push("fc-event-start"),t.isEnd&&o.push("fc-event-end"),o=o.concat(e.className),e.source&&(o=o.concat(e.source.className||[])),n+=r?"a href='"+q(e.url)+"'":"div",n+=" class='"+o.join(" ")+"' style='position:absolute;top:"+t.top+"px;left:"+t.left+"px;"+a+"'><div class='fc-event-inner'><div class='fc-event-time'>"+q(ae(e.start,e.end,y("timeFormat")))+"</div><div class='fc-event-title'>"+q(e.title||"")+"</div></div><div class='fc-event-bg'></div>",t.isEnd&&b(e)&&(n+="<div class='ui-resizable-handle ui-resizable-s'>=</div>"),n+="</"+(r?"a":"div")+">"}function d(e,t,n){var r=t.find("div.fc-event-time");_(e)&&g(e,t,r),n.isEnd&&b(e)&&h(e,t,r),E(e,t)}function p(e,t,n){function r(){c||(t.width(a).height("").draggable("option","grid",null),c=!0)}var a,o,i,l=n.isStart,c=!0,u=O(),d=B(),p=V(),g=z(),h=R();t.draggable({opacity:y("dragOpacity","month"),revertDuration:y("dragRevertDuration"),start:function(n,h){C("eventDragStart",t,e,n,h),J(e,t),a=t.width(),u.start(function(n,a){if(Z(),n){o=!1;var u=H(0,a.col),h=H(0,n.col);i=v(h,u),n.row?l?c&&(t.width(d-10),S(t,p*Math.round((e.end?(e.end-e.start)/Oe:y("defaultEventMinutes"))/g)),t.draggable("option","grid",[d,1]),c=!1):o=!0:(K(s(f(e.start),i),s(D(e),i)),r()),o=o||c&&!i}else r(),o=!0;t.draggable("option","revert",o)},n,"drag")},stop:function(n,a){if(u.stop(),Z(),C("eventDragStop",t,e,n,a),o)r(),t.css("filter",""),Y(e,t);else{var l=0;c||(l=Math.round((t.offset().top-j().offset().top)/p)*g+h-(60*e.start.getHours()+e.start.getMinutes())),X(this,e,i,l,c,n,a)}}})}function g(e,t,n){function r(){Z(),l&&(d?(n.hide(),t.draggable("option","grid",null),K(s(f(e.start),_),s(D(e),_))):(a(b),n.css("display",""),t.draggable("option","grid",[S,M])))}function a(t){var r,a=u(f(e.start),t);e.end&&(r=u(f(e.end),t)),n.text(ae(a,r,y("timeFormat")))}var o,i,l,c,d,p,g,h,_,b,T,w=m.getCoordinateGrid(),E=U(),S=B(),M=V(),A=z();t.draggable({scroll:!1,grid:[S,M],axis:1==E&&"y",opacity:y("dragOpacity"),revertDuration:y("dragRevertDuration"),start:function(n,r){C("eventDragStart",t,e,n,r),J(e,t),w.build(),o=t.position(),i=w.cell(n.pageX,n.pageY),l=c=!0,d=p=N(i),g=h=0,_=0,b=T=0},drag:function(e,n){var a=w.cell(e.pageX,e.pageY);if(l=!!a){if(d=N(a),g=Math.round((n.position.left-o.left)/S),g!=h){var s=H(0,i.col),u=i.col+g;u=Math.max(0,u),u=Math.min(E-1,u);var f=H(0,u);_=v(f,s)}d||(b=Math.round((n.position.top-o.top)/M)*A)}l==c&&d==p&&g==h&&b==T||(r(),c=l,p=d,h=g,T=b),t.draggable("option","revert",!l)},stop:function(n,a){Z(),C("eventDragStop",t,e,n,a),l&&(d||_||b)?X(this,e,_,d?0:b,d,n,a):(l=!0,d=!1,g=0,_=0,b=0,r(),t.css("filter",""),t.css(o),Y(e,t))}})}function h(e,t,n){var r,a,o=V(),i=z();t.resizable({handles:{s:".ui-resizable-handle"},grid:o,start:function(n,o){r=a=0,J(e,t),C("eventResizeStart",this,e,n,o)},resize:function(l,s){r=Math.round((Math.max(o,t.height())-s.originalSize.height)/o),r!=a&&(n.text(ae(e.start,r||e.end?u(T(e),i*r):null,y("timeFormat"))),a=r)},stop:function(n,a){C("eventResizeStop",this,e,n,a),r?Q(this,e,0,i*r,n,a):Y(e,t)}})}var m=this;m.renderEvents=n,m.clearEvents=r,m.slotSegHtml=c,pe.call(m);var y=m.opt,C=m.trigger,_=m.isEventDraggable,b=m.isEventResizable,T=m.eventEnd,E=m.eventElementHandlers,A=m.setHeight,$=m.getDaySegmentContainer,F=m.getSlotSegmentContainer,O=m.getHoverListener,L=m.getMaxMinute,R=m.getMinMinute,k=m.timePosition,N=m.getIsCellAllDay,I=m.colContentLeft,P=m.colContentRight,H=m.cellToDate,U=m.getColCnt,B=m.getColWidth,V=m.getSnapHeight,z=m.getSnapMinutes,j=m.getSlotContainer,G=m.reportEventElement,Y=m.showEvents,J=m.hideEvents,X=m.eventDrop,Q=m.eventResize,K=m.renderDayOverlay,Z=m.clearOverlays,ee=m.renderDayEvents,te=m.calendar,re=te.formatDate,ae=te.formatDates;m.draggableDayEvent=p}function ne(e){var t,n=re(e),r=n[0];if(ae(n),r){for(t=0;t<r.length;t++)oe(r[t]);for(t=0;t<r.length;t++)ie(r[t],0,0)}return le(n)}function re(e){var t,n,r,a=[];for(t=0;t<e.length;t++){for(n=e[t],r=0;r<a.length&&se(n,a[r]).length;r++);(a[r]||(a[r]=[])).push(n)}return a}function ae(e){var t,n,r,a,o;for(t=0;t<e.length;t++)for(n=e[t],r=0;r<n.length;r++)for(a=n[r],a.forwardSegs=[],o=t+1;o<e.length;o++)se(a,e[o],a.forwardSegs)}function oe(e){var n,r,a=e.forwardSegs,o=0;if(e.forwardPressure===t){for(n=0;n<a.length;n++)r=a[n],oe(r),o=Math.max(o,1+r.forwardPressure);e.forwardPressure=o;
}}function ie(e,n,r){var a,o=e.forwardSegs;if(e.forwardCoord===t)for(o.length?(o.sort(ue),ie(o[0],n+1,r),e.forwardCoord=o[0].backwardCoord):e.forwardCoord=1,e.backwardCoord=e.forwardCoord-(e.forwardCoord-r)/(n+1),a=0;a<o.length;a++)ie(o[a],0,e.forwardCoord)}function le(e){var t,n,r,a=[];for(t=0;t<e.length;t++)for(n=e[t],r=0;r<n.length;r++)a.push(n[r]);return a}function se(e,t,n){n=n||[];for(var r=0;r<t.length;r++)ce(e,t[r])&&n.push(t[r]);return n}function ce(e,t){return e.end>t.start&&e.start<t.end}function ue(e,t){return t.forwardPressure-e.forwardPressure||(e.backwardCoord||0)-(t.backwardCoord||0)||de(e,t)}function de(e,t){return e.start-t.start||t.end-t.start-(e.end-e.start)||(e.event.title||"").localeCompare(t.event.title)}function fe(n,r,a){function o(t,n){var r=G[t];return e.isPlainObject(r)?H(r,n||a):r}function i(e,t){return r.trigger.apply(r,[e,t||P].concat(Array.prototype.slice.call(arguments,2),[P]))}function l(e){var t=e.source||{};return j(e.startEditable,t.startEditable,o("eventStartEditable"),e.editable,t.editable,o("editable"))&&!o("disableDragging")}function c(e){var t=e.source||{};return j(e.durationEditable,t.durationEditable,o("eventDurationEditable"),e.editable,t.editable,o("editable"))&&!o("disableResizing")}function d(e){W={};var t,n,r=e.length;for(t=0;t<r;t++)n=e[t],W[n._id]?W[n._id].push(n):W[n._id]=[n]}function p(){W={},V={},z=[]}function g(e){return e.end?f(e.end):q(e)}function h(e,t){z.push({event:e,element:t}),V[e._id]?V[e._id].push(t):V[e._id]=[t]}function m(){e.each(z,function(e,t){P.trigger("eventDestroy",t.event,t.event,t.element)})}function y(e,t){t.click(function(n){if(!t.hasClass("ui-draggable-dragging")&&!t.hasClass("ui-resizable-resizing"))return i("eventClick",this,e,n)}).hover(function(t){i("eventMouseover",this,e,t)},function(t){i("eventMouseout",this,e,t)})}function C(e,t){b(e,t,"show")}function _(e,t){b(e,t,"hide")}function b(e,t,n){var r,a=V[e._id],o=a.length;for(r=0;r<o;r++)t&&a[r][0]==t[0]||a[r][n]()}function D(e,t,n,r,a,o,l){var s=t.allDay,c=t._id;w(W[c],n,r,a),i("eventDrop",e,t,n,r,a,function(){w(W[c],-n,-r,s),B(c)},o,l),B(c)}function T(e,t,n,r,a,o){var l=t._id;E(W[l],n,r),i("eventResize",e,t,n,r,function(){E(W[l],-n,-r),B(l)},a,o),B(l)}function w(e,n,r,a){r=r||0;for(var o,i=e.length,l=0;l<i;l++)o=e[l],a!==t&&(o.allDay=a),u(s(o.start,n,!0),r),o.end&&(o.end=u(s(o.end,n,!0),r)),U(o,G)}function E(e,t,n){n=n||0;for(var r,a=e.length,o=0;o<a;o++)r=e[o],r.end=u(s(g(r),t,!0),n),U(r,G)}function S(e){return"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(e=e.getDay()),X[e]}function M(){return Y}function A(e,t,n){for(t=t||1;X[(e.getDay()+(n?t:0)+7)%7];)s(e,t)}function $(){var e=F.apply(null,arguments),t=x(e),n=O(t);return n}function F(e,t){var n=P.getColCnt(),r=Z?-1:1,a=Z?n-1:0;"object"==("undefined"==typeof e?"undefined":_typeof(e))&&(t=e.col,e=e.row);var o=e*n+(t*r+a);return o}function x(e){var t=P.visStart.getDay();return e+=Q[t],7*Math.floor(e/Y)+K[(e%Y+Y)%Y]-t}function O(e){var t=f(P.visStart);return s(t,e),t}function L(e){var t=R(e),n=k(t),r=N(n);return r}function R(e){return v(e,P.visStart)}function k(e){var t=P.visStart.getDay();return e+=t,Math.floor(e/7)*Y+Q[(e%7+7)%7]-Q[t]}function N(e){var t=P.getColCnt(),n=Z?-1:1,r=Z?t-1:0,a=Math.floor(e/t),o=(e%t+t)%t*n+r;return{row:a,col:o}}function I(e,t){for(var n=P.getRowCnt(),r=P.getColCnt(),a=[],o=R(e),i=R(t),l=k(o),s=k(i)-1,c=0;c<n;c++){var u=c*r,d=u+r-1,f=Math.max(l,u),p=Math.min(s,d);if(f<=p){var v=N(f),g=N(p),h=[v.col,g.col].sort(),m=x(f)==o,y=x(p)+1==i;a.push({row:c,leftCol:h[0],rightCol:h[1],isStart:m,isEnd:y})}}return a}var P=this;P.element=n,P.calendar=r,P.name=a,P.opt=o,P.trigger=i,P.isEventDraggable=l,P.isEventResizable=c,P.setEventData=d,P.clearEventData=p,P.eventEnd=g,P.reportEventElement=h,P.triggerEventDestroy=m,P.eventElementHandlers=y,P.showEvents=C,P.hideEvents=_,P.eventDrop=D,P.eventResize=T;var q=P.defaultEventEnd,U=r.normalizeEvent,B=r.reportEventChange,W={},V={},z=[],G=r.options;P.isHiddenDay=S,P.skipHiddenDays=A,P.getCellsPerWeek=M,P.dateToCell=L,P.dateToDayOffset=R,P.dayOffsetToCellOffset=k,P.cellOffsetToCell=N,P.cellToDate=$,P.cellToCellOffset=F,P.cellOffsetToDayOffset=x,P.dayOffsetToDate=O,P.rangeToSegments=I;var Y,J=o("hiddenDays")||[],X=[],Q=[],K=[],Z=o("isRTL");!function(){o("weekends")===!1&&J.push(0,6);for(var t=0,n=0;t<7;t++)Q[t]=n,X[t]=e.inArray(t,J)!=-1,X[t]||(K[n]=t,n++);if(Y=n,!Y)throw"invalid hiddenDays"}()}function pe(){function t(e,t){var n=r(e,!1,!0);ge(n,function(e,t){L(e.event,t)}),_(n,t),ge(n,function(e,t){$("eventAfterRender",e.event,e.event,t)})}function n(e,t,n){var a=r([e],!0,!1),o=[];return ge(a,function(e,r){e.row===t&&r.css("top",n),o.push(r[0])}),o}function r(t,n,r){var o,s,c=Q(),f=n?e("<div/>"):c,p=a(t);return i(p),o=l(p),f[0].innerHTML=o,S.calendar.options.compiler(f[0])(S.calendar.options.compile_scope),s=f.children(),n&&c.append(s),u(p,s),ge(p,function(e,t){e.hsides=M(t,!0)}),ge(p,function(e,t){t.width(Math.max(0,e.outerWidth-e.hsides))}),ge(p,function(e,t){e.outerHeight=t.outerHeight(!0)}),d(p,r),p}function a(e){for(var t=[],n=0;n<e.length;n++){var r=o(e[n]);t.push.apply(t,r)}return t}function o(e){for(var t=e.start,n=D(e),r=re(t,n),a=0;a<r.length;a++)r[a].event=e;return r}function i(e){for(var t=A("isRTL"),n=0;n<e.length;n++){var r=e[n],a=(t?r.isEnd:r.isStart)?J:G,o=(t?r.isStart:r.isEnd)?X:Y,i=a(r.leftCol),l=o(r.rightCol);r.left=i,r.outerWidth=l-i}}function l(e){var t="";S.calendar.options.compile_scope.segments=e;for(var n=0;n<e.length;n++)t+=c(e[n],n);return t}function c(e,t){var n="",r=(A("isRTL"),e.event),a=r.url,o=["fc-event","fc-event-hori"];F(r)&&o.push("fc-event-draggable"),e.isStart&&o.push("fc-event-start"),e.isEnd&&o.push("fc-event-end"),o=o.concat(r.className),r.source&&(o=o.concat(r.source.className||[]));var i=W(r,A),l=V(e);return e.event.toolTipPos=l.position,n+=a?"<a href='"+q(a)+"'":"<div",n+=" class='"+o.join(" ")+"' data-date='"+q(C(r.start,"yyyy-MM-dd"))+"' data-rate='"+q(r.rate||"")+"' data-room-type='"+q(r.roomType||"")+"'",e.event.toolTipData&&""!==e.event.toolTipData.bestAvailableRate&&"undefined"!==r.toolTipData&&(n+="qtipfc qtip-template='/assets/partials/reservation/rvTooltipContent.html'qtip-template-object='segments["+t+"]' qtip-at='"+l.at+"' qtip-my='"+l.my+"'"),n+=" style='position:absolute;left:"+e.left+"px;"+i+"'><div class='fc-event-inner'>",!r.allDay&&e.isStart&&(n+="<span class='fc-event-time'>"+q(K(r.start,r.end,A("timeFormat")))+"</span>"),n+="<span class='fc-event-day'>"+q(r.day||"")+"</span>","undefined"!=typeof r.toolTipData&&"undefined"!=typeof r.currencySymbol?(r.toolTipData.restrictions.length>0&&(n+=" <span class='restrictions'>R</span>"),n+="<span class='fc-event-title'><span class='icon'></span>",parseInt(r.title)>0&&"undefined"!==r.currencySymbol&&(n+=q(r.currencySymbol))):n+="<span class='fc-event-title'><span class='icon'></span>",n+=q(r.title||"")+"</span></div>",e.isEnd&&x(r),n+="</"+(a?"a":"div")+">"}function u(t,n){for(var r=0;r<t.length;r++){var a=t[r],o=a.event,i=n.eq(r),l=$("eventRender",o,o,i);l===!1?i.remove():(l&&l!==!0&&(l=e(l).css({position:"absolute",left:a.left}),i.replaceWith(l),i=l),a.element=i)}}function d(e,t){var n=p(e),r=y(),a=[];if(t)for(var o=0;o<r.length;o++)r[o].height(n[o]);for(var o=0;o<r.length;o++)a.push(r[o].position().top);ge(e,function(e,t){t.css("top",a[e.row]+e.top)})}function p(e){for(var t=B(),n=z(),r=[],a=g(e),o=0;o<t;o++){for(var i=a[o],l=[],s=0;s<n;s++)l.push(0);for(var c=0;c<i.length;c++){var u=i[c];u.top=I(l.slice(u.leftCol,u.rightCol+1));for(var s=u.leftCol;s<=u.rightCol;s++)l[s]=u.top+u.outerHeight}r.push(I(l))}return r}function g(e){var t,n,r,a=B(),o=[];for(t=0;t<e.length;t++)n=e[t],r=n.row,n.element&&(o[r]?o[r].push(n):o[r]=[n]);for(r=0;r<a;r++)o[r]=h(o[r]||[]);return o}function h(e){for(var t=[],n=m(e),r=0;r<n.length;r++)t.push.apply(t,n[r]);return t}function m(e){e.sort(he);for(var t=[],n=0;n<e.length;n++){for(var r=e[n],a=0;a<t.length&&ve(r,t[a]);a++);t[a]?t[a].push(r):t[a]=[r]}return t}function y(){var e,t=B(),n=[];for(e=0;e<t;e++)n[e]=j(e).find("div.fc-day-content > div");return n}function _(e,t){var n=Q();ge(e,function(e,n,r){var a=e.event;a._id===t?b(a,n,e):n[0]._fci=r}),w(n,e,b)}function b(e,t,n){F(e)&&S.draggableDayEvent(e,t,n),n.isEnd&&x(e)&&S.resizableDayEvent(e,t,n),R(e,t)}function T(t,n){var r,a=ne(),o={id:t._id,url:t.url,nameid:t.nameID,title:t.title,rate:t.rate,roomType:t.roomType,className:t.className,day:t.day,allDay:t.allDay,start:t.start,end:t.end,startEditable:t.startEditable};n.data("eventObject",o),n.draggable({delay:50,zIndex:9999,opacity:A("dragOpacity"),revertDuration:A("dragRevertDuration"),start:function(e,o){$("eventDragStart",n,t,e,o),N(t,n),a.start(function(e,a,o,i){if(n.draggable("option","revert",!e||!o&&!i),ee(),e){var l=ae(a),c=ae(e);r=v(c,l),Z(s(f(t.start),r),s(D(t),r))}else r=0},e,"drag")},stop:function(o,i){a.stop();e(document).unbind("mousemove"),ee(),$("eventDragStop",n,t,o,i),r?P(this,t,r,0,t.allDay,o,i):(n.css("filter",""),k(t,n))}})}function E(t,r,a){var o=A("isRTL"),i=o?"w":"e",l=r.find(".ui-resizable-"+i),c=!1;U(r),r.mousedown(function(e){e.preventDefault()}).click(function(e){c&&(e.preventDefault(),e.stopImmediatePropagation())}),l.mousedown(function(o){function l(n){$("eventResizeStop",this,t,n),e("body").css("cursor",""),f.stop(),ee(),u&&H(this,t,u,0,n),setTimeout(function(){c=!1},0)}if(1==o.which){c=!0;var u,d,f=ne(),p=(B(),z(),r.css("top")),v=e.extend({},t),g=se(le(t.start));te(),e("body").css("cursor",i+"-resize").one("mouseup",l),$("eventResizeStart",this,t,o),f.start(function(r,o){if(r){var l=oe(o),c=oe(r);if(c=Math.max(c,g),u=ie(c)-ie(l)){v.end=s(O(t),u,!0);var f=d;d=n(v,a.row,p),d=e(d),d.find("*").css("cursor",i+"-resize"),f&&f.remove(),N(t)}else d&&(k(t),d.remove(),d=null);ee(),Z(t.start,s(D(t),u))}},o)}})}var S=this;S.renderDayEvents=t,S.draggableDayEvent=T,S.resizableDayEvent=E;var A=S.opt,$=S.trigger,F=S.isEventDraggable,x=S.isEventResizable,O=S.eventEnd,L=S.reportEventElement,R=S.eventElementHandlers,k=S.showEvents,N=S.hideEvents,P=S.eventDrop,H=S.eventResize,B=S.getRowCnt,z=S.getColCnt,j=(S.getColWidth,S.allDayRow),G=S.colLeft,Y=S.colRight,J=S.colContentLeft,X=S.colContentRight,Q=(S.dateToCell,S.getDaySegmentContainer),K=S.calendar.formatDates,Z=S.renderDayOverlay,ee=S.clearOverlays,te=S.clearSelection,ne=S.getHoverListener,re=S.rangeToSegments,ae=S.cellToDate,oe=S.cellToCellOffset,ie=S.cellOffsetToDayOffset,le=S.dateToDayOffset,se=S.dayOffsetToCellOffset}function ve(e,t){for(var n=0;n<t.length;n++){var r=t[n];if(r.leftCol<=e.rightCol&&r.rightCol>=e.leftCol)return!0}return!1}function ge(e,t){for(var n=0;n<e.length;n++){var r=e[n],a=r.element;a&&t(r,a,n)}}function he(e,t){return t.rightCol-t.leftCol-(e.rightCol-e.leftCol)||t.event.allDay-e.event.allDay||e.event.start-t.event.start||(e.event.title||"").localeCompare(t.event.title)}function me(){function t(e,t,a){n(),t||(t=s(e,a)),c(e,t,a),r(e,t,a)}function n(e){d&&(d=!1,u(),l("unselect",null,e))}function r(e,t,n,r){d=!0,l("select",null,e,t,n,r)}function a(t){var a=o.cellToDate,l=o.getIsCellAllDay,s=o.getHoverListener(),d=o.reportDayClick;if(1==t.which&&i("selectable")){n(t);var f;s.start(function(e,t){u(),e&&l(e)?(f=[a(t),a(e)].sort(N),c(f[0],f[1],!0)):f=null},t),e(document).one("mouseup",function(e){s.stop(),f&&(+f[0]==+f[1]&&d(f[0],!0,e),r(f[0],f[1],!0,e))})}}var o=this;o.select=t,o.unselect=n,o.reportSelection=r,o.daySelectionMousedown=a;var i=o.opt,l=o.trigger,s=o.defaultSelectionEnd,c=o.renderSelection,u=o.clearSelection,d=!1;i("selectable")&&i("unselectAuto")&&e(document).mousedown(function(t){var r=i("unselectCancel");r&&e(t.target).parents(r).length||n(t)})}function ye(){function t(t,n){var r=o.shift();return r||(r=e("<div class='fc-cell-overlay' style='position:absolute;z-index:3'/>")),r[0].parentNode!=n[0]&&r.appendTo(n),a.push(r.css(t).show()),r}function n(){for(var e;e=a.shift();)o.push(e.hide().unbind())}var r=this;r.renderOverlay=t,r.clearOverlays=n;var a=[],o=[]}function Ce(e){var t,n,r=this;r.build=function(){t=[],n=[],e(t,n)},r.cell=function(e,r){var a,o=t.length,i=n.length,l=-1,s=-1;for(a=0;a<o;a++)if(r>=t[a][0]&&r<t[a][1]){l=a;break}for(a=0;a<i;a++)if(e>=n[a][0]&&e<n[a][1]){s=a;break}return l>=0&&s>=0?{row:l,col:s}:null},r.rect=function(e,r,a,o,i){var l=i.offset();return{top:t[e][0]-l.top,left:n[r][0]-l.left,width:n[o][1]-n[r][0],height:t[a][1]-t[e][0]}}}function _e(t){function n(e){be(e);var n=t.cell(e.pageX,e.pageY);(!n!=!i||n&&(n.row!=i.row||n.col!=i.col))&&(n?(o||(o=n),a(n,o,n.row-o.row,n.col-o.col)):a(n,o),i=n)}var r,a,o,i,l=this;l.start=function(l,s,c){a=l,o=i=null,t.build(),n(s),r=c||"mousemove",e(document).bind(r,n)},l.stop=function(){return e(document).unbind(r,n),i}}function be(e){e.pageX===t&&(e.pageX=e.originalEvent.pageX,e.pageY=e.originalEvent.pageY)}function De(e){function n(t){return a[t]=a[t]||e(t)}var r=this,a={},o={},i={};r.left=function(e){return o[e]=o[e]===t?n(e).position().left:o[e]},r.right=function(e){return i[e]=i[e]===t?r.left(e)+n(e).width():i[e]},r.clear=function(){a={},o={},i={}}}var Te={nameID:0,defaultView:"month",aspectRatio:1.47,header:{left:"title",center:"",right:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberCalculation:"iso",weekNumberTitle:"W",allDayDefault:!0,ignoreTimezone:!0,lazyFetching:!0,startParam:"start",endParam:"end",titleFormat:{month:"MMMM yyyy",week:"MMM d[ yyyy]{ '&#8212;'[ MMM] d yyyy}",day:"dddd, MMM d, yyyy"},columnFormat:{month:"ddd",week:"ddd M/d",day:"dddd M/d"},timeFormat:{"":"h(:mm)t"},isRTL:!1,firstDay:0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],buttonText:{prev:"<span class='fc-text-arrow'>&lsaquo;</span>",next:"<span class='fc-text-arrow'>&rsaquo;</span>",prevYear:"<span class='fc-text-arrow'>&laquo;</span>",nextYear:"<span class='fc-text-arrow'>&raquo;</span>",today:"today",month:"month",week:"week",day:"day"},theme:!1,buttonIcons:{prev:"circle-triangle-w",next:"circle-triangle-e"},unselectAuto:!0,dropAccept:"*",handleWindowResize:!0},we={header:{left:"next,prev today",center:"",right:"title"},buttonText:{prev:"<span class='fc-text-arrow'>&rsaquo;</span>",next:"<span class='fc-text-arrow'>&lsaquo;</span>",prevYear:"<span class='fc-text-arrow'>&raquo;</span>",nextYear:"<span class='fc-text-arrow'>&laquo;</span>"},buttonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w"}},Ee=e.fullCalendar={version:"1.6.4"},Se=Ee.views={};e.fn.fullCalendar=function(n){if("string"==typeof n){var a,o=Array.prototype.slice.call(arguments,1);return this.each(function(){var r=e.data(this,"fullCalendar");if(r&&e.isFunction(r[n])){var i=r[n].apply(r,o);a===t&&(a=i),"destroy"==n&&e.removeData(this,"fullCalendar")}}),a!==t?a:this}n=n||{};var i=n.eventSources||[];return delete n.eventSources,n.events&&(i.push(n.events),delete n.events),n=e.extend(!0,{},Te,n.isRTL||n.isRTL===t&&Te.isRTL?we:{},n),this.each(function(t,a){var o=e(a),l=new r(o,n,i);o.data("fullCalendar",l),l.render()}),this},Ee.sourceNormalizers=[],Ee.sourceFetchers=[];var Me={dataType:"json",cache:!1},Ae=1;Ee.addDays=s,Ee.cloneDate=f,Ee.parseDate=h,Ee.parseISO8601=m,Ee.parseTime=y,Ee.formatDate=C,Ee.formatDates=_;var $e=["sun","mon","tue","wed","thu","fri","sat"],Fe=864e5,xe=36e5,Oe=6e4,Le={s:function(e){return e.getSeconds()},ss:function(e){return P(e.getSeconds())},m:function(e){return e.getMinutes()},mm:function(e){return P(e.getMinutes())},h:function(e){return e.getHours()%12||12},hh:function(e){return P(e.getHours()%12||12)},H:function(e){return e.getHours()},HH:function(e){return P(e.getHours())},d:function(e){return e.getDate()},dd:function(e){return P(e.getDate())},ddd:function(e,t){return t.dayNamesShort[e.getDay()]},dddd:function(e,t){return t.dayNames[e.getDay()]},M:function(e){return e.getMonth()+1},MM:function(e){return P(e.getMonth()+1)},MMM:function(e,t){return t.monthNamesShort[e.getMonth()]},MMMM:function(e,t){return t.monthNames[e.getMonth()]},yy:function(e){return(e.getFullYear()+"").substring(2)},yyyy:function(e){return e.getFullYear()},t:function(e){return e.getHours()<12?"a":"p"},tt:function(e){return e.getHours()<12?"am":"pm"},T:function(e){return e.getHours()<12?"A":"P"},TT:function(e){return e.getHours()<12?"AM":"PM"},u:function(e){return C(e,"yyyy-MM-dd'T'HH:mm:ss'Z'")},S:function(e){var t=e.getDate();return t>10&&t<20?"th":["st","nd","rd"][t%10-1]||"th"},w:function(e,t){return t.weekNumberCalculation(e)},W:function(e){return b(e)}};Ee.dateFormatters=Le,Ee.applyAll=z,Se.month=G,Se.basicWeek=Y,Se.basicDay=J,n({weekMode:"fixed"}),Se.agendaWeek=K,Se.agendaDay=Z,n({allDaySlot:!0,allDayText:"all-day",firstHour:6,slotMinutes:30,defaultEventMinutes:120,axisFormat:"h(:mm)tt",timeFormat:{agenda:"h:mm{ - h:mm}"},dragOpacity:{agenda:.5},minTime:0,maxTime:24,slotEventOverlap:!0})}(jQuery),function(e){function t(t,n,l){var s=t.success,c=e.extend({},t.data||{},{"start-min":r(n,"u"),"start-max":r(l,"u"),singleevents:!0,"max-results":9999}),u=t.currentTimezone;return u&&(c.ctz=u=u.replace(" ","_")),e.extend({},t,{url:t.url.replace(/\/basic$/,"/full")+"?alt=json-in-script&callback=?",dataType:"jsonp",data:c,startParam:!1,endParam:!1,success:function(t){var n=[];t.feed.entry&&e.each(t.feed.entry,function(t,r){var i,l=r.gd$when[0].startTime,s=a(l,!0),c=a(r.gd$when[0].endTime,!0),d=l.indexOf("T")==-1;e.each(r.link,function(e,t){"text/html"==t.type&&(i=t.href,u&&(i+=(i.indexOf("?")==-1?"?":"&")+"ctz="+u))}),d&&o(c,-1),n.push({id:r.gCal$uid.value,title:r.title.$t,url:i,start:s,end:c,allDay:d,location:r.gd$where[0].valueString,description:r.content.$t})});var r=[n].concat(Array.prototype.slice.call(arguments,1)),l=i(s,this,r);return e.isArray(l)?l:n}})}var n=e.fullCalendar,r=n.formatDate,a=n.parseISO8601,o=n.addDays,i=n.applyAll;n.sourceNormalizers.push(function(e){("gcal"==e.dataType||void 0===e.dataType&&(e.url||"").match(/^(http|https):\/\/www.google.com\/calendar\/feeds\//))&&(e.dataType="gcal",void 0===e.editable&&(e.editable=!1))}),n.sourceFetchers.push(function(e,n,r){if("gcal"==e.dataType)return t(e,n,r)}),n.gcalFeed=function(t,n){return e.extend({},n,{url:t,dataType:"gcal"})}}(jQuery),sntRover.directive("includeReplace",function(){return{require:"ngInclude",restrict:"A",link:function(e,t,n){t.replaceWith(t.children())}}}),sntRover.directive("rvFileCloudStorage",function(){return{restrict:"AE",replace:"true",scope:{cardType:"@",cardId:"@",showFiles:"=",cardName:"@",accountType:"@"},templateUrl:"/assets/directives/fileCloudStorage/partials/rvFileCloudStorage.html",controller:"rvFileCloudStorageAndNotesCtrl"}}),sntRover.controller("rvCardNotesCtrl",["$scope","rvFileCloudStorageSrv","rvCardNotesSrv","$filter","$rootScope",function(e,t,n,r,a){BaseCtrl.call(this,e);var o=function(t){var n={card_id:e.cardId,card_type:e.cardType,note_id:t,text:e.cardData.noteText,description:e.cardData.noteText};return"stay_card"===e.cardType&&(delete n.card_id,n.reservation_id=e.cardId),"group"!==e.cardType&&"allotment"!==e.cardType||(n.group_id=n.card_id,n.allotment_id=n.card_id,n.notes=e.cardData.noteText,n.associated_id=n.card_id,n.associated_type="group"===e.cardType?"Group":"Allotment",n.id=n.note_id,n.text=n.notes),n},i=function(e){return _.each(e,function(e){e.posted_user_image_url=e.avatar,e.posted_user_first_name=e.user_name,e.posted_user_last_name="",e.posted_user_image_url=e.avatar,e.text=e.note}),e},l=function(e){return _.each(e,function(e){e.posted_user_image_url=e.user_image,e.posted_user_first_name=e.username,e.posted_user_last_name="",e.text=e.text,e.time=e.posted_time,e.date=e.posted_date,e.id=e.note_id}),e},s=function(e){return _.each(e,function(e){e.posted_user_image_url=e.user_image,e.posted_user_first_name=e.username,e.posted_user_last_name="",e.text=e.description,e.time=e.posted_time,e.date=e.posted_date,e.id=e.note_id}),e};e.sortByDate=function(e){var t=moment(e.date+" "+e.time,"MM-DD-YYYY hh:mm A");return t};var c=function(){var t={params:o(),successCallBack:function(t){"account"===e.cardType?t.notes=i(t.notes):"stay_card"===e.cardType?(t.notes=t.notes.reservation_notes,t.notes=l(t.notes)):"group"!==e.cardType&&"allotment"!==e.cardType||(t.notes=s(t.notes)),e.notes=t.notes,e.$emit("NOTES_COUNT_UPDATED",e.notes),e.refreshScroller("card_notes_scroller")}};e.callAPI(n.fetchNotes,t)};e.createNewNote=function(){var t=o(),r={params:t,successCallBack:function(){e.cardData.noteText="",c()}};e.callAPI(n.createNote,r)},e.clickedOnNote=function(t){e.editingNote=t,e.cardData.noteText=t.text},e.cancelEditMode=function(){e.editingNote=null,e.cardData.noteText=""},e.updateActiveNote=function(){var t=o(e.editingNote.id),r={params:t,successCallBack:c};e.callAPI(n.updateNote,r)},e.deleteCardNote=function(t,r){t.stopPropagation(),e.cancelEditMode();var a=o(r),i={params:a,successCallBack:c};e.callAPI(n.deleteNote,i)},e.formatDateForUI=function(e){return r("date")(new tzIndependentDate(e),a.dateFormat)},e.$on("FETCH_NOTES",function(){c(),e.setScroller("card_notes_scroller",{})}),function(){e.cardData.noteText="",e.editingNote=null,e.notes=[],e.cardData.noteText="",e.noNotesText=r("translate")("NO_NOTES_SUB")+" # "+e.cardName}()}]),sntRover.controller("rvFileCloudStorageAndNotesCtrl",["$scope","rvFileCloudStorageSrv","RVHotelDetailsSrv","$controller",function(e,t,n,r){e.screenModeChanged=function(t){e.$broadcast("FETCH_"+t)},function(){e.cardData={notesViewOn:!0,cloudType:n.hotelDetails.cloud_storage_config.cloud_storage_type},r("rvCardNotesCtrl",{$scope:e}),r("rvFileCloudStorageCtrl",{$scope:e}),e.$broadcast("FETCH_NOTES"),e.errorMessage="";var t={preventDefaultException:{tagName:/^(INPUT|LI)$/},preventDefault:!1};e.setScroller("card_file_list_scroller",t)}()}]),sntRover.controller("rvFileCloudStorageCtrl",["$scope","rvFileCloudStorageSrv","$timeout","sntActivity","$filter","ngDialog","rvPermissionSrv",function(e,t,n,r,a,o,i){e.cardData.fileList=[],e.cardData.selectedFileList=[];var l,s=[],c=function(){var t=e.getScroller("card_file_list_scroller");n(function(){t.scrollTo(0,0,300)},0)},u=["tif","tiff","bmp","jpg","jpeg","gif","png"],d=["csv","numbers","xsls","sheet","excel"],f=["keynote","ppt","powerpoint"],p=function(n,r){var a={id:e.cardId,application:"ROVER",action_type:n,details:[r],card_type:e.cardType},o={params:a,loader:"NONE"};e.callAPI(t.recordReservationActions,o)},v=function(e){var t=e.split("/")[1],n=t.split(".")[t.split(".").length-1],r=n.split("-")[n.split("-").length-1];return r="powerpoint"===r?"ppt":r},g=function(){e.errorMessage="",r.start("FETCH_FILES"),t.fetchFiles({card_id:e.cardId,card_type:e.cardType}).then(function(t){r.stop("FETCH_FILES"),e.cardData.fileTypes=[],_.each(t,function(t){var n=_.findIndex(e.cardData.selectedFileList,function(e){return e.id===t.id});t.is_selected=n!==-1,t.full_content_type=angular.copy(t.content_type),t.content_type=t.content_type?v(t.content_type):"",e.cardData.fileTypes=_.union(e.cardData.fileTypes,[t.content_type])}),e.cardData.fileList=t,e.refreshScroller("card_file_list_scroller"),e.cardData.firstFileFetch=!1},function(){r.stop("FETCH_FILES"),e.errorMessage=[a("translate")("FILE_FETCHING_FAILED")],e.cardData.firstFileFetch=!1})},h=function(){l&&(l.close(),l="")};e.$on("FILE_UPLOADED",function(t,o){if(!e.cardData.hasUploadFilePermission)return void n(function(){e.errorMessage=[a("translate")("NO_FILE_UPLOAD_PERMISSION")],e.cardData.dragInProgress=!1,r.stop("UPLOADING_FILES")},100);var i={file_name:o.name,content_type:o.type,base64_data:o.base64?o.base64.split(";base64,")[1]:"",card_id:e.cardId,card_type:e.cardType};e.cardData.newFile=o,s.push(i),n(function(){e.cardData.dragInProgress=!1},100)}),e.fileSelectionChanged=function(){e.cardData.selectedFileList=_.filter(e.cardData.fileList,function(e){return e.is_selected})},e.cancelFileSelection=function(){_.each(e.cardData.fileList,function(e){e.is_selected=!1}),e.fileSelectionChanged()},e.getFileCount=function(t){var n=_.filter(e.cardData.fileList,function(e){return e.content_type===t});return n.length},e.filterChanged=function(){e.refreshScroller("card_file_list_scroller"),c()},e.fileUploadCompleted=function(){var n=0,o=function(){n++,n===s.length&&(r.stop("UPLOADING_FILES"),p("FILES_UPLOADED",{key:"File(s)",new_value:_.map(angular.copy(s),function(e){return e.file_name}).join(", ")}),s=[],e.cardData.newFile={},g(),h())};s.length&&r.start("UPLOADING_FILES"),e.errorMessage="",_.each(s,function(n){n.card_type=e.cardType,t.uploadFile(n).then(o,function(){r.stop("UPLOADING_FILES"),e.errorMessage=[a("translate")("FILE_UPLOADING_FAILED")]})})},e.fileReplaced=function(){r.start("UPLOADING_FILES"),e.errorMessage="";var n=function(){r.stop("UPLOADING_FILES"),p("FILE_UPDATED",{key:"File",new_value:_.map(angular.copy(s),function(e){return e.file_name}).join(", "),old_value:e.selectedFile.file_name}),s=[],e.cardData.newFile={},g(),h()},o=angular.copy(s[0]);o.id=e.selectedFile.id,t.updateFile(o).then(n,function(){r.stop("UPLOADING_FILES"),e.errorMessage=[a("translate")("FILE_UPLOADING_FAILED")]})},e.replaceFile=function(){$("#replace-file").trigger("click")},e.$on("FILE_UPLOADED_DONE",e.fileUploadCompleted),e.donwloadFiles=function(n){var a=n?[n]:e.cardData.selectedFileList,o=0;r.start("DOWNLOADING_FILES");var i=new JSZip,l=function(){var e={key:"File(s)",new_value:_.map(angular.copy(a),function(e){return e.file_name}).join(", ")};p("FILES_DOWNLOADED",e)},s=function(t,n){if(o++,1===a.length){var s=document.createElement("a");s.href="data:"+n.full_content_type+";base64,"+t.base64_data,s.download=n.file_name,s.click(),r.stop("DOWNLOADING_FILES"),l()}else i.file(n.file_name,t.base64_data,{base64:!0});console.log(o+"---------"+a.length);var c={guest_card:"GUEST",stay_card:"RESERVATION"};1!==a.length&&o===a.length&&(i.generateAsync({type:"blob"}).then(function(t){var n=(c[e.cardType]?c[e.cardType]:e.cardType)+"_"+e.cardId+".zip";saveAs(t,n)}),r.stop("DOWNLOADING_FILES"),l())};_.each(a,function(e){t.downLoadFile({id:e.id}).then(function(t){s(t,e)},function(){r.stop("DOWNLOADING_FILES")})})},e.deleteFiles=function(n){var o=n?[n]:e.cardData.selectedFileList;r.start("DELETING_FILES");var i=0,l=function(){i++,i===o.length&&(r.stop("DELETING_FILES"),p("FILES_DELETED",{key:"File(s)",old_value:_.map(angular.copy(o),function(e){return e.file_name}).join(", ")}),e.cardData.selectedFileList=[],h(),g())};_.each(o,function(n){t.deleteFile({id:n.id}).then(l,function(){r.stop("DELETING_FILES"),e.errorMessage=[a("translate")("FILE_DELETION_FAILED")]})})},e.$on("FETCH_FILES",function(){e.cardData.firstFileFetch=!0,g()}),e.sortFiles=function(e){var t=e.updated_date+" "+e.updated_time,n=moment(t,"MM-DD-YYYY hh:mm A");return n},e.openFileDetails=function(t){e.cardData.hasViewFilePermission&&(e.selectedFile=t,l=o.open({template:"/assets/directives/fileCloudStorage/partials/rvFileDetails.html",className:"",scope:e,closeByDocument:!1,closeByEscape:!1}))},e.closeFileDetailsPopup=function(){h()},e.isImageAndHasThumbNail=function(e){var t=_.indexOf(u,e.content_type);return t!==-1&&e.preview_url},e.getIconClass=function(e){var t="icon-document";return"document"===e||"pdf"===e?t="icon-document":_.indexOf(d,e)!==-1?t="icon-sheet":_.indexOf(f,e)!==-1&&(t="icon-presentation"),t},e.getContentTypeClass=function(e){var t;return"pdf"===e?t="pdf":_.indexOf(d,e)!==-1?t="sheet":_.indexOf(f,e)!==-1&&(t="presentation"),t},e.showAddFile=function(){return"account"===e.cardType?t.activeCardType==="ACCOUNT_"+e.accountType:t.activeCardType===e.cardType},function(){"account"===e.cardType?t.activeCardType="ACCOUNT_"+e.accountType:t.activeCardType=angular.copy(e.cardType),e.cardData.newFile={base64:"",name:"",size:"",type:""},e.cardData.hasFilePersmissions=!0,e.cardData.sort_files_by="NEWLY_ADDED",e.cardData.group_files_by="UNGROUPED",e.cardData.searchText="",e.cardData.dragInProgress=!1,e.selectedFile="",e.cardData.hasViewFilePermission=i.getPermissionValue("CLOUD_STORAGE_VIEW"),e.cardData.hasUploadFilePermission=i.getPermissionValue("CLOUD_STORAGE_UPLOAD"),e.cardData.hasDownloadFilePermission=i.getPermissionValue("CLOUD_STORAGE_DOWNLOAD"),e.cardData.hasDeleteFilePermission=i.getPermissionValue("CLOUD_STORAGE_DELETE")}()}]),sntRover.controller("rvStayCardNotesAndFileCtrl",["$scope","rvFileCloudStorageSrv","RVHotelDetailsSrv","$controller",function(e,t,n,r){e.screenModeChanged=function(t){e.$broadcast("FETCH_"+t)},e.$on("$destroy",function(){t.activeCardType=angular.copy(t.previousActiveCardType)}),function(){t.previousActiveCardType=angular.copy(t.activeCardType);var a="stay_card",o=e.reservationData.reservation_card.reservation_id;e.cardId=o,e.cardType=a,e.cardData={notesViewOn:!0,cloudType:n.hotelDetails.cloud_storage_config.cloud_storage_type},e.showFiles=e.isCloudStorageEnabledForCardType(a),r("rvCardNotesCtrl",{$scope:e}),r("rvFileCloudStorageCtrl",{$scope:e}),e.$broadcast("FETCH_NOTES"),e.errorMessage="";var i={preventDefaultException:{tagName:/^(INPUT|LI)$/},preventDefault:!1};e.setScroller("card_file_list_scroller",i)}()}]),angular.module("sntRover").service("rvCardNotesSrv",["$q","rvBaseWebSrvV2",function(e,t){var n=this,r=function(e,t){"guest_card"===t.card_type?n.baseApiURL="/api/guest_details/"+t.card_id+"/notes":"account"===t.card_type&&(n.baseApiURL="/api/accounts/"+t.card_id);var r={guest_card:{fetch:n.baseApiURL,create:n.baseApiURL,update:n.baseApiURL+"/"+t.note_id,delete:n.baseApiURL+"/"+t.note_id},account:{fetch:n.baseApiURL+"/account_notes",create:n.baseApiURL+"/save_account_note",update:n.baseApiURL+"/update_account_note",delete:n.baseApiURL+"/delete_account_note?note_id="+t.note_id},stay_card:{fetch:"/api/reservations/"+t.reservation_id+"/notes",create:"/reservation_notes",update:"/reservation_notes/"+t.note_id,delete:"/reservation_notes/"+t.note_id},group:{fetch:"/api/groups/"+t.card_id,create:"/api/groups/save_group_note",update:"/api/notes/"+t.note_id,delete:"/api/groups/delete_group_note?note_id="+t.note_id},allotment:{fetch:"/api/allotments/"+t.card_id,create:"/api/allotments/save_allotment_note",update:"/api/notes/"+t.note_id,delete:"/api/allotments/delete_allotment_note?note_id="+t.note_id}};return r[t.card_type][e]};n.fetchNotes=function(e){var n=r("fetch",e);return t.getJSON(n)},n.createNote=function(e){var n=r("create",e);return t.postJSON(n,e)},n.updateNote=function(e){var n=r("update",e);return t.putJSON(n,e)},n.deleteNote=function(e){var n=r("delete",e);return t.deleteJSON(n)}}]),sntRover.service("rvFileCloudStorageSrv",["$q","rvBaseWebSrvV2",function(e,t){var n=this;n.fetchFiles=function(e){var n="/api/file_attachments";return e.card_type="allotment"===e.card_type?"group":e.card_type,t.getJSON(n,e)},n.uploadFile=function(e){var n="/api/file_attachments";return e.card_type="allotment"===e.card_type?"group":e.card_type,t.postJSON(n,e)},n.downLoadFile=function(e){var n="/api/file_attachments/"+e.id+"/download";return e.card_type="allotment"===e.card_type?"group":e.card_type,t.getJSON(n,e)},n.deleteFile=function(e){var n="/api/file_attachments/"+e.id;return e.card_type="allotment"===e.card_type?"group":e.card_type,t.deleteJSON(n,e)},n.updateFile=function(e){var n="/api/file_attachments/"+e.id;return e.card_type="allotment"===e.card_type?"group":e.card_type,t.putJSON(n,e)},n.recordReservationActions=function(e){var n="/api/file_attachments/record_activity";return t.postJSON(n,e)},n.previousActiveCardType="",n.activeCardType=""}]),angular.module("sntRover").directive("convertToNumber",function(){return{require:"ngModel",link:function(e,t,n,r){r.$parsers.push(function(e){return isFinite(parseInt(e,10))?parseInt(e,10):e}),r.$formatters.push(function(e){return angular.isUndefined(e)?"":""+e})}}}),angular.module("sntRover").directive("stringToNumber",function(){return{require:"ngModel",link:function(e,t,n,r){r.$parsers.push(function(e){return""+e}),r.$formatters.push(function(e){return parseFloat(e)})}}}),angular.module("snt.utils").directive("sntSessionTimeout",function(){
var e=["$scope","sessionTimeoutHandlerSrv","ngDialog","sntSharedLoginSrv","$rootScope","sntActivity","$timeout","sntAuthorizationSrv","$window",function(e,t,n,r,a,o,i,l,s){var c;e.loginData={};var u="account has been locked",d=function(){a.$broadcast("resetLoader"),s.localStorage.removeItem("jwt"),c||(e.loginData.autoLogoutDelay=Math.floor(t.getAutoLogoutDelay()/1e3/60<<0),c=n.open({template:"/assets/partials/rvExtendSessionModal.html",className:"ngdialog-theme-default",scope:e,closeByEscape:!1,closeByDocument:!1}))};e.continueSession=function(){var a={email:t.getLoginEmail(),password:e.loginData.password};e.hasError=!1,e.errorMessage="",o.start("API_REQ"),r.login(a).then(function(t){"success"===t.status&&(n.close(c.id),c=null,e.loginData={}),o.stop("API_REQ")},function(t){e.hasError="failure"===t.status,e.errorMessage=_.isArray(t.errors)?t.errors[0]:"",e.loginData.password="",o.stop("API_REQ"),e.errorMessage&&e.errorMessage.indexOf(u)>-1&&i(function(){s.location.href="/logout"},500)})},e.logout=function(){o.start("API_REQ"),r.logout().finally(function(){i(function(){t.getWorker()&&t.stopTimer(),o.stop("API_REQ"),s.location.href="/logout"})})};var f=function(){var e=function(e){e.auto_logout_delay&&t.setAutoLogoutDelay(1e3*e.auto_logout_delay),t.setLoginEmail(e.login),h()};t.getAutoLogoutDelay()||r.getSessionDetails().then(e)};e.$on("CLOSE_SESSION_TIMEOUT_POPUP",function(){c&&c.close()}),e.$on("SET_HOTEL",function(){f()});var p=function(){r.refreshToken().then(function(){})},v=function(){var e=0;return $(document).idleTimer("isIdle")&&(e=Math.floor($(document).idleTimer("getElapsedTime")/1e3)),e},g=function(e){var n=Math.floor(t.getAutoLogoutDelay()/1e3);v()+30>n-15||e?d():p()},h=function(){$(document).idleTimer({timeout:3e4,timerSyncId:"sntIdleTimer"}),$(document).on("idle.idleTimer",function(){c||p()}),s.document.addEventListener("wheel",function(){$(document).idleTimer("reset")},!0)},m=function(){t.getWorker()||(t.initWorker(),i(function(){t.getWorker().addEventListener("message",function(e){var t=e.data;switch(t.cmd){case"SHOW_TIMEOUT_POPUP":g(t.isApiTokenExpired)}})},500))};m()}];return{restrict:"EA",require:"^ngModel",controller:e}}),sntRover.directive("rvDropFile",function(){return{restrict:"A",scope:{dragInProgress:"="},link:function(e,t){var n=0;t.bind("dragover",function(e){e.stopPropagation(),e.preventDefault()}),t.bind("dragenter",function(t){t.stopPropagation(),t.preventDefault(),n=(new Date).getTime(),e.$apply(function(){e.dragInProgress=!0})}),t.bind("dragleave",function(t){t.stopPropagation(),t.preventDefault(),(new Date).getTime()-n>5&&e.$apply(function(){e.dragInProgress=!1})}),t.bind("drop",function(t){t.stopPropagation(),t.preventDefault();for(var n,r=t.originalEvent&&t.originalEvent.dataTransfer?t.originalEvent.dataTransfer.files:[],a=0,o=0;n=r[o];o++){var i=new FileReader;i.onload=function(t){return function(n){var o={name:t.name,type:t.type,size:t.size,lastModifiedDate:t.lastModifiedDate,base64:n.target.result};e.$emit("FILE_UPLOADED",o),a++,a===r.length&&e.$apply(function(){e.$emit("FILE_UPLOADED_DONE")})}}(n),i.onerror=function(){e.$apply(function(){e.dragInProgress=!1})},i.readAsDataURL(n)}})}}}),sntRover.directive("imgError",function(){return{link:function(e,t){t.bind("error",function(){t.attr("src","/ui/pms-ui/images/preview_not_available.png")})}}});